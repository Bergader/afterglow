<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.web.routes.visualizer documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Afterglow</span> <span class="project-version">0.2.2</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.beyond.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beyond</span></div></a></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push-2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push-2</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mini</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mk2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mk2</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-pro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-pro</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.tempo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tempo</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.coremidi4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coremidi4j</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.cues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cues</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-3"><a href="afterglow.effects.show-variable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-variable</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.american-dj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>american-dj</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.qxf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qxf</span></div></a></li><li class="depth-2 branch"><a href="afterglow.init.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shows</span></div></div></li><li class="depth-3"><a href="afterglow.shows.sallie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sallie</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="afterglow.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.show-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-control</span></div></a></li><li class="depth-4 branch current"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.web-repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web-repl</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-active-fixtures"><div class="inner"><span>active-fixtures</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-active.3F"><div class="inner"><span>active?</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-adjusted-positions"><div class="inner"><span>adjusted-positions</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-adjusted-rotations"><div class="inner"><span>adjusted-rotations</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-axis-shift"><div class="inner"><span>axis-shift</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-byte-to-double"><div class="inner"><span>byte-to-double</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-current-colors"><div class="inner"><span>current-colors</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-current-pan-tilts"><div class="inner"><span>current-pan-tilts</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-max-lights"><div class="inner"><span>max-lights</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-page"><div class="inner"><span>page</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-shader"><div class="inner"><span>shader</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-shader-offsets"><div class="inner"><span>shader-offsets</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-shader-scale"><div class="inner"><span>shader-scale</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-show-span"><div class="inner"><span>show-span</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-update-preview"><div class="inner"><span>update-preview</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.visualizer.html#var-visualizer-pan-tilt"><div class="inner"><span>visualizer-pan-tilt</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">afterglow.web.routes.visualizer</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-active-fixtures"><h3>active-fixtures</h3><div class="usage"><code>(active-fixtures show)</code></div><div class="doc"><div class="markdown"><p>Return the fixtures which should currently be rendered, because they are emitting light.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L119">view source</a></div></div><div class="public anchor" id="var-active.3F"><h3>active?</h3><div class="usage"><code>(active? show [id fixture-or-head])</code></div><div class="doc"><div class="markdown"><p>Check whether the given fixture (represented as a tuple of [id spec], as found in a show’s :visualizer-visible map) should be included in the current visualizer frame, because it is emitting light.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L110">view source</a></div></div><div class="public anchor" id="var-adjusted-positions"><h3>adjusted-positions</h3><div class="usage"><code>(adjusted-positions lights show scale)</code></div><div class="doc"><div class="markdown"><p>Move the spotlights so they all fit within the shader’s bounding cube, which extends from [-0.5, 0.25, 0.5] to [0.5, -0.25, 0].</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L62">view source</a></div></div><div class="public anchor" id="var-adjusted-rotations"><h3>adjusted-rotations</h3><div class="usage"><code>(adjusted-rotations show)</code></div><div class="doc"><div class="markdown"><p>Get the current orientations of the active spotlights for the visualizer. Return as a series of columns of the rotation matrices, since it looks like WebGL or THREE.js is a lot happier passing vectors than matrices as uniforms.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L72">view source</a></div></div><div class="public anchor" id="var-axis-shift"><h3>axis-shift</h3><div class="usage"><code>(axis-shift show axis origin available-span scale)</code></div><div class="doc"><div class="markdown"><p>Determine how much we need to translate show space points along an axis after they have been scaled to move them into the shader’s bounding cube. If there is extra room for this axis, center it within the bounding cube.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L38">view source</a></div></div><div class="public anchor" id="var-byte-to-double"><h3>byte-to-double</h3><div class="usage"><code>(byte-to-double val)</code></div><div class="doc"><div class="markdown"><p>Convert a one-byte color component, as used in Afterglow, to a floating point color component as used in OpenGL, where 255 becomes 1.0.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L135">view source</a></div></div><div class="public anchor" id="var-current-colors"><h3>current-colors</h3><div class="usage"><code>(current-colors lights show)</code></div><div class="doc"><div class="markdown"><p>Get the current color values of the active spotlights for the visualizer. Return as a series of four-element vectors of red, green, blue, and alpha.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L142">view source</a></div></div><div class="public anchor" id="var-current-pan-tilts"><h3>current-pan-tilts</h3><div class="usage"><code>(current-pan-tilts lights show)</code></div><div class="doc"><div class="markdown"><p>Get the current pan and tilt values of the active spotlights for the visualizer. Return as a series of two-element vectors of pan and tilt angles in the perspective of the visualizer, to save space compared to sending actual rotation matrices.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L125">view source</a></div></div><div class="public anchor" id="var-max-lights"><h3>max-lights</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The maximum number of lights that the visualizer will attempt to render. Adjust this based on the performance of your graphics hardware.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L10">view source</a></div></div><div class="public anchor" id="var-page"><h3>page</h3><div class="usage"><code>(page show-id)</code></div><div class="doc"><div class="markdown"><p>Render the real-time show preview.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L151">view source</a></div></div><div class="public anchor" id="var-shader"><h3>shader</h3><div class="usage"><code>(shader show-id)</code></div><div class="doc"><div class="markdown"><p>Render a GLSL shader capable of volumetric rendering of enough lights to accommodate the current show.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L165">view source</a></div></div><div class="public anchor" id="var-shader-offsets"><h3>shader-offsets</h3><div class="usage"><code>(shader-offsets show scale)</code></div><div class="doc"><div class="markdown"><p>Determine the values to add to the coordinates of scaled light positions to move them inside the shader’s bounding cube, whose origin is [-0.5, -0.25, 0].</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L54">view source</a></div></div><div class="public anchor" id="var-shader-scale"><h3>shader-scale</h3><div class="usage"><code>(shader-scale show)</code></div><div class="doc"><div class="markdown"><p>Determine how much we need to scale the show so it fits in the shader’s bounding cube which has a width of 1.0, a height of 0.5, and a depth of 0.5. We are not going to shift lights down to the floor, though.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L28">view source</a></div></div><div class="public anchor" id="var-show-span"><h3>show-span</h3><div class="usage"><code>(show-span show axis)</code></div><div class="doc"><div class="markdown"><p>Determine the degree to which a show spreads over an axis. For the X and Z axes, this is simply the difference in bounding box coordinates. For Y, we want to preserve height from the floor, so we use zero as a lower bound on the minimum coordinate.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L15">view source</a></div></div><div class="public anchor" id="var-update-preview"><h3>update-preview</h3><div class="usage"><code>(update-preview show-id)</code></div><div class="doc"><div class="markdown"><p>Render updated lighting information for the preview.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L177">view source</a></div></div><div class="public anchor" id="var-visualizer-pan-tilt"><h3>visualizer-pan-tilt</h3><div class="usage"><code>(visualizer-pan-tilt head pan tilt)</code></div><div class="doc"><div class="markdown"><p>Given a head and DMX pan and tilt values, calculate the pan and tilt angles to send the visualizer</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/visualizer.clj#L89">view source</a></div></div></div></body></html>