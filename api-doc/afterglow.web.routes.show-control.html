<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.web.routes.show-control documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Afterglow</span> <span class="project-version">0.2.1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.beyond.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beyond</span></div></a></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mini</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-pro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-pro</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.tempo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tempo</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.coremidi4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coremidi4j</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.cues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cues</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-3"><a href="afterglow.effects.show-variable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-variable</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.american-dj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>american-dj</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.qxf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qxf</span></div></a></li><li class="depth-2 branch"><a href="afterglow.init.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shows</span></div></div></li><li class="depth-3"><a href="afterglow.shows.sallie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sallie</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="afterglow.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4 branch current"><a href="afterglow.web.routes.show-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-control</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.web-repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web-repl</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-build-sync-select"><div class="inner"><span>build-sync-select</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-clients"><div class="inner"><span>clients</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-cue-view"><div class="inner"><span>cue-view</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-effect-time-formatter"><div class="inner"><span>effect-time-formatter</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-get-ui-updates"><div class="inner"><span>get-ui-updates</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-hundredths"><div class="inner"><span>hundredths</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-link-controller"><div class="inner"><span>link-controller</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-load-update"><div class="inner"><span>load-update</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-metronome-bpm-delta-for-event"><div class="inner"><span>metronome-bpm-delta-for-event</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-metronome-changes"><div class="inner"><span>metronome-changes</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-metronome-delta-for-event"><div class="inner"><span>metronome-delta-for-event</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-metronome-states"><div class="inner"><span>metronome-states</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-post-ui-event"><div class="inner"><span>post-ui-event</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-show-page"><div class="inner"><span>show-page</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-status-update"><div class="inner"><span>status-update</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-sync-menu-changes"><div class="inner"><span>sync-menu-changes</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-unlink-controller"><div class="inner"><span>unlink-controller</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-update-known-controllers"><div class="inner"><span>update-known-controllers</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-update-known-dj-link-sync-sources"><div class="inner"><span>update-known-dj-link-sync-sources</span></div></a></li><li class="depth-1"><a href="afterglow.web.routes.show-control.html#var-update-known-midi-sync-sources"><div class="inner"><span>update-known-midi-sync-sources</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">afterglow.web.routes.show-control</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-build-sync-select"><h3>build-sync-select</h3><div class="usage"><code>(build-sync-select page-id)</code></div><div class="doc"><div class="markdown"><p>Creates the list needed by the template which renders the HTML interface allowing the user to link to one of the currently available sources of metronome synchronization, with the current selection, if any, properly identified.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L440">view source</a></div></div><div class="public anchor" id="var-clients"><h3>clients</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Tracks the active show interface pages, and any pending interface updates for each.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L86">view source</a></div></div><div class="public anchor" id="var-cue-view"><h3>cue-view</h3><div class="usage"><code>(cue-view show left bottom width height holding snapshot)</code></div><div class="doc"><div class="markdown"><p>Returns a nested structure of rows of cue information starting at the specified origin, with the specified width and height. Ideal for looping over and rendering in textual form, such as in a HTML table. Each cell contains a tuple [cue effect], the cue assigned to that grid location, and the currently-running effect, if any, launched from that cue. Cells which do not have associated cues still be assigned a unique cue ID (identifying page-relative coordinates, with zero at the lower left) so they can be updated if a cue is created for that slot while the page is still up.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L60">view source</a></div></div><div class="public anchor" id="var-effect-time-formatter"><h3>effect-time-formatter</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The format to use when showing the time an effect was started. See the <a href="https://github.com/clj-time/clj-time">clj-time documentation</a> if you want details of how to set up a different format string.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L257">view source</a></div></div><div class="public anchor" id="var-get-ui-updates"><h3>get-ui-updates</h3><div class="usage"><code>(get-ui-updates id)</code></div><div class="doc"><div class="markdown"><p>Route which delivers any changes which need to be applied to a show web interface to reflect differences in the current show state compared to when it was last updated.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L513">view source</a></div></div><div class="public anchor" id="var-hundredths"><h3>hundredths</h3><div class="usage"><code>(hundredths n)</code></div><div class="doc"><div class="markdown"><p>Given a value from 0 to 1, return it as a rounded number of hundredths, except return 99 when it would round to 100, since it has to tie in with a whole value that we cannot easily increment. Used to provide information about the fractional beat and second at which an effect was started in the web interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L263">view source</a></div></div><div class="public anchor" id="var-link-controller"><h3>link-controller</h3><div class="usage"><code>(link-controller page-id controller)</code></div><div class="doc"><div class="markdown"><p>Tie the cue grid display to that of a physical grid controller, so that they scroll in tandem.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L656">view source</a></div></div><div class="public anchor" id="var-load-update"><h3>load-update</h3><div class="usage"><code>(load-update page-id)</code></div><div class="doc"><div class="markdown"><p>If the show is running and we haven’t sent a load update in the last half second, send one.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L479">view source</a></div></div><div class="public anchor" id="var-metronome-bpm-delta-for-event"><h3>metronome-bpm-delta-for-event</h3><div class="usage"><code>(metronome-bpm-delta-for-event page-info kind)</code></div><div class="doc"><div class="markdown"><p>If the UI event name submitted by a show page corresponds to a metronome bpm shift, and the metronome is not synced, return the appropriate bpm adjustment.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L729">view source</a></div></div><div class="public anchor" id="var-metronome-changes"><h3>metronome-changes</h3><div class="usage"><code>(metronome-changes page-id snapshot)</code></div><div class="doc"><div class="markdown"><p>Return the list of changes that should be applied to the show metronome section since the last time it was updated.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L405">view source</a></div></div><div class="public anchor" id="var-metronome-delta-for-event"><h3>metronome-delta-for-event</h3><div class="usage"><code>(metronome-delta-for-event page-info kind)</code></div><div class="doc"><div class="markdown"><p>If the UI event name submitted by a show page corresponds to a metronome shift, return the appropriate number of milliseconds.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L717">view source</a></div></div><div class="public anchor" id="var-metronome-states"><h3>metronome-states</h3><div class="usage"><code>(metronome-states show last-states snap)</code></div><div class="doc"><div class="markdown"><p>Gather details about the current state of the main show metronome.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L392">view source</a></div></div><div class="public anchor" id="var-post-ui-event"><h3>post-ui-event</h3><div class="usage"><code>(post-ui-event id kind req)</code></div><div class="doc"><div class="markdown"><p>Route which reports a user interaction with the show web interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L749">view source</a></div></div><div class="public anchor" id="var-show-page"><h3>show-page</h3><div class="usage"><code>(show-page show-id)</code></div><div class="doc"><div class="markdown"><p>Renders the web interface for interacting with the specified show.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L205">view source</a></div></div><div class="public anchor" id="var-status-update"><h3>status-update</h3><div class="usage"><code>(status-update page-id)</code></div><div class="doc"><div class="markdown"><p>If the running or error status of the show has changed, send an update about it.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L489">view source</a></div></div><div class="public anchor" id="var-sync-menu-changes"><h3>sync-menu-changes</h3><div class="usage"><code>(sync-menu-changes page-id)</code></div><div class="doc"><div class="markdown"><p>Return any changes that should be applied to the menu of available metronome sync options since the last time it was updated.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L465">view source</a></div></div><div class="public anchor" id="var-unlink-controller"><h3>unlink-controller</h3><div class="usage"><code>(unlink-controller page-id)</code></div><div class="doc"><div class="markdown"><p>Remove any physical grid controller currently linked to scroll in tandem.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L644">view source</a></div></div><div class="public anchor" id="var-update-known-controllers"><h3>update-known-controllers</h3><div class="usage"><code>(update-known-controllers page-id)</code></div><div class="doc"><div class="markdown"><p>Makes sure the cached page information contains list of the currently-registered physical grid controllers associated with a page’s show, assigning each a unique id number, so they can be selected in the user interface for scrolling or linking to. If this list changed, return the new list so it can be sent as an update to the page.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L98">view source</a></div></div><div class="public anchor" id="var-update-known-dj-link-sync-sources"><h3>update-known-dj-link-sync-sources</h3><div class="usage"><code>(update-known-dj-link-sync-sources page-id)</code></div><div class="doc"><div class="markdown"><p>Updates the cached information to contain current list of Pro DJ Link sync sources seen on the network, assigning each a unique id number, so they can be selected in the sync interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L183">view source</a></div></div><div class="public anchor" id="var-update-known-midi-sync-sources"><h3>update-known-midi-sync-sources</h3><div class="usage"><code>(update-known-midi-sync-sources page-id)</code></div><div class="doc"><div class="markdown"><p>Scans for sources of MIDI clock pulses, and updates the cached page information to contain current list, assigning each a unique id number, so they can be selected in the sync interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/web/routes/show_control.clj#L157">view source</a></div></div></div></body></html>