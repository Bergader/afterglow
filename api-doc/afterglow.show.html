<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.show documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Afterglow</span> <span class="project-version">0.2.1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.beyond.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beyond</span></div></a></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mini</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mk2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mk2</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-pro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-pro</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.tempo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tempo</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.coremidi4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coremidi4j</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.cues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cues</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-3"><a href="afterglow.effects.show-variable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-variable</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.american-dj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>american-dj</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.qxf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qxf</span></div></a></li><li class="depth-2 branch"><a href="afterglow.init.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch current"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shows</span></div></div></li><li class="depth-3"><a href="afterglow.shows.sallie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sallie</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="afterglow.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.show-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-control</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.web-repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web-repl</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.show.html#var-active-effect-keys"><div class="inner"><span>active-effect-keys</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-effect.21"><div class="inner"><span>add-effect!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-effect-from-cue-grid.21"><div class="inner"><span>add-effect-from-cue-grid!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-empty-buffer-fn.21"><div class="inner"><span>add-empty-buffer-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-frame-fn.21"><div class="inner"><span>add-frame-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-midi-control-metronome-align-bar-mapping"><div class="inner"><span>add-midi-control-metronome-align-bar-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-midi-control-metronome-align-phrase-mapping"><div class="inner"><span>add-midi-control-metronome-align-phrase-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-midi-control-metronome-reset-mapping"><div class="inner"><span>add-midi-control-metronome-reset-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-midi-control-to-master-mapping"><div class="inner"><span>add-midi-control-to-master-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-midi-control-to-var-mapping"><div class="inner"><span>add-midi-control-to-var-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-send-buffer-fn.21"><div class="inner"><span>add-send-buffer-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-add-variable-set-fn.21"><div class="inner"><span>add-variable-set-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-address-map"><div class="inner"><span>address-map</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-all-fixtures"><div class="inner"><span>all-fixtures</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-blackout-show"><div class="inner"><span>blackout-show</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-blackout-universe"><div class="inner"><span>blackout-universe</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-clear-effects.21"><div class="inner"><span>clear-effects!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-clear-empty-buffer-fn.21"><div class="inner"><span>clear-empty-buffer-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-clear-frame-fn.21"><div class="inner"><span>clear-frame-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-clear-send-buffer-fn.21"><div class="inner"><span>clear-send-buffer-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-clear-variable-set-fn.21"><div class="inner"><span>clear-variable-set-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-current-load"><div class="inner"><span>current-load</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-default-refresh-interval"><div class="inner"><span>default-refresh-interval</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-end-effect.21"><div class="inner"><span>end-effect!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-find-cue-grid-active-effect"><div class="inner"><span>find-cue-grid-active-effect</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-find-effect"><div class="inner"><span>find-effect</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-fixtures-named"><div class="inner"><span>fixtures-named</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-get-variable"><div class="inner"><span>get-variable</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-ola-failure-description"><div class="inner"><span>ola-failure-description</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-patch-fixture.21"><div class="inner"><span>patch-fixture!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-patch-fixture-group.21"><div class="inner"><span>patch-fixture-group!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-profile-show"><div class="inner"><span>profile-show</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-register-grid-controller"><div class="inner"><span>register-grid-controller</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-register-show"><div class="inner"><span>register-show</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-remove-fixture.21"><div class="inner"><span>remove-fixture!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-remove-midi-control-metronome-mapping"><div class="inner"><span>remove-midi-control-metronome-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-remove-midi-control-to-master-mapping"><div class="inner"><span>remove-midi-control-to-master-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-remove-midi-control-to-var-mapping"><div class="inner"><span>remove-midi-control-to-var-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-resolution-order"><div class="inner"><span>resolution-order</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-running.3F"><div class="inner"><span>running?</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-set-extension-resolution-order.21"><div class="inner"><span>set-extension-resolution-order!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-set-variable.21"><div class="inner"><span>set-variable!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-show"><div class="inner"><span>show</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-shows"><div class="inner"><span>shows</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-start.21"><div class="inner"><span>start!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-stop.21"><div class="inner"><span>stop!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-stop-all.21"><div class="inner"><span>stop-all!</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-sync-status"><div class="inner"><span>sync-status</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-sync-to-external-clock"><div class="inner"><span>sync-to-external-clock</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-unregister-grid-controller"><div class="inner"><span>unregister-grid-controller</span></div></a></li><li class="depth-1"><a href="afterglow.show.html#var-unregister-show"><div class="inner"><span>unregister-show</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">afterglow.show</h1><div class="doc"><div class="markdown"><p>Encapsulates a synchronized light show, executing a varying collection of effects with output to a number of DMX universes. Assumes control of the assigned universes, so only one show at a time should be assigned a given universe. Of course, you can stack as many effects as you’d like in that show.</p>
<p>The effects are maintained in a priority queue, with higher-priority effects running after lower-priority ones, so they can adjust or simply replace the channel assignments established by earlier effects. Some may choose to implement traditional channel-oriented highest-takes-prority or latest-takes-priority semantics, others do more sophisticated color blending or position averageing. The default priority when adding an effect is zero, but you can assign it any integer, and it will be inserted into the queue after any existing effects with the same priority.</p>
<p>All effects are assigned a keyword when they are added, and adding a new effect with the same key as an existing effect will replace the former one.</p></div></div><div class="public anchor" id="var-active-effect-keys"><h3>active-effect-keys</h3><div class="usage"><code>(active-effect-keys show)</code></div><div class="doc"><div class="markdown"><p>Returns a set of the keywords assigned to all currently-active effects.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1164">view source</a></div></div><div class="public anchor" id="var-add-effect.21"><h3>add-effect!</h3><div class="usage"><code>(add-effect! key effect &amp; {:keys [priority from-cue x y var-map], :or {priority 0}})</code></div><div class="doc"><div class="markdown"><p>Add an effect to the active set which are affecting DMX outputs for <a href="afterglow.show-context.html#var-*show*">show-context/*show*</a>. If no priority is specified, zero is used. This effect is added after all existing effects with equal or lower priority, and replaces any existing effect with the same key. Since the effects are executed in order, ones which come later will win when setting DMX values for the same channel if that channel uses latest-takes-priority mode; for channels using highest-takes priority, the order does not matter. Effects can also use more sophisticated strategies for adjusting the results of earlier effects, but the later one always gets to decide what to do.</p>
<p>Returns the unique id assigned to this particular effect activation, so that user interfaces can detect whether it is still active.</p>
<p>The <code>:from-cue</code> keyword argument is used, along with <code>:x</code> and <code>:y</code>, to keep track of effects which were launched from the cue grid, to help provide feedback on control surfaces and in the web interface. <code>:var-map</code> is used to supply a map of variable bindings associated with the cue, also for use by interfaces which support them.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L852">view source</a></div></div><div class="public anchor" id="var-add-effect-from-cue-grid.21"><h3>add-effect-from-cue-grid!</h3><div class="usage"><code>(add-effect-from-cue-grid! x y &amp; {:keys [velocity var-overrides], :or {velocity 127}})</code></div><div class="doc"><div class="markdown"><p>Finds the cue, if any, at the specified grid coordinates, and activates its effect with the designated key and priority, after ending any effects whose keys are specified in the cue’s <code>:end-keys</code>. Returns the id of the new effect, or nil if no cue was found.</p>
<p>Any cue variables which are configured to be responsive to MIDI velocity will be set according to the velocity value passed in with <code>:velocity</code>. If no velocity is specified, then a default velocity of <code>127</code> is assumed.</p>
<p>A map of variable keywords to values can be supplied with <code>:var-overrides</code>, and the corresponding value will be used rather than the <code>:start</code> value specified in the cue for that variable when it is introduced as a cue variable. This is used by compound cues to launch their nested cues with customized values, and by <a href="https://github.com/brunchboy/afterglow-max">afterglow-max</a> to start cues with alternate values if its patchers have been configured to do so. If a <code>:var-override</code> is specified for a variable which is also configured as velocity sensitive, the override will win.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L950">view source</a></div></div><div class="public anchor" id="var-add-empty-buffer-fn.21"><h3>add-empty-buffer-fn!</h3><div class="usage"><code>(add-empty-buffer-fn! f)</code></div><div class="doc"><div class="markdown"><p>Arranges for the supplied function to be called when the Afterglow rendering loop is clearing its DMX buffers in order to calculate a frame of lighting effects. The function must take no arguments.</p>
<p>This is how custom assigner types which do not result in DMX data, such as the Pangolin <a href="afterglow.beyond.html#var-beyond-server">beyond-server</a> laser show integration, register their extension functions to participate in the rendering loop.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L265">view source</a></div></div><div class="public anchor" id="var-add-frame-fn.21"><h3>add-frame-fn!</h3><div class="usage"><code>(add-frame-fn! f)</code></div><div class="doc"><div class="markdown"><p>Arranges for the supplied function to be called when the Afterglow rendering loop is going to sleep prior to rendering the next frame of lighting effects. The function will be given the metronome snapshot that will be in effect when the next frame gets rendered, so that it can preconfigure anything needed for the rendering process. This is used, for example, to allow <a href="https://github.com/brunchboy/afterglow-max#afterglow-max">afterglow-max</a> patchers to set show variables for the next frame, since they cannot be queried directly during the rendering process.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L243">view source</a></div></div><div class="public anchor" id="var-add-midi-control-metronome-align-bar-mapping"><h3>add-midi-control-metronome-align-bar-mapping</h3><div class="usage"><code>(add-midi-control-metronome-align-bar-mapping device-filter channel control-number &amp; {:keys [metronome], :or {metronome (:metronome *show*)}})</code></div><div class="doc"><div class="markdown"><p>Adjust a metronome so the closest beat is considered the first in the current measure, without moving the beat, when a control-change message with non-zero value is received from the specified device, <code>channel</code>, and <code>control-number</code>.</p>
<p>The first MIDI input source whose device matches the <code>device-filter</code> (using <a href="afterglow.midi.html#var-filter-devices">filter-devices</a>) will be chosen.</p>
<p>If keyword parameter <code>:metronome</code> is supplied, its value can either be a <a href="afterglow.rhythm.html#var-metronome">rhythm/metronome</a> object, or a keyword naming a show variable containing such an object. If not supplied, the main metronome attached to <a href="afterglow.show-context.html#var-*show*">*show*</a> is unmapped.</p>
<p>Returns a MIDI mapping function which can be passed to <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> if you later want to stop the metronome from being affected by these MIDI messages.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L733">view source</a></div></div><div class="public anchor" id="var-add-midi-control-metronome-align-phrase-mapping"><h3>add-midi-control-metronome-align-phrase-mapping</h3><div class="usage"><code>(add-midi-control-metronome-align-phrase-mapping device-filter channel control-number &amp; {:keys [metronome], :or {metronome (:metronome *show*)}})</code></div><div class="doc"><div class="markdown"><p>Adjust a metronome so the closest beat is considered the first in the current phrase, without moving the beat, when a control-change message with non-zero value is received from the specified device, <code>channel</code>, and <code>control-number</code>.</p>
<p>The first MIDI input source whose device matches the <code>device-filter</code> (using <a href="afterglow.midi.html#var-filter-devices">filter-devices</a>) will be chosen.</p>
<p>If keyword parameter <code>:metronome</code> is supplied, its value can either be a <a href="afterglow.rhythm.html#var-metronome">rhythm/metronome</a> object, or a keyword naming a show variable containing such an object. If not supplied, the main metronome attached to <a href="afterglow.show-context.html#var-*show*">*show*</a> is mapped.</p>
<p>Returns a MIDI mapping function which can be passed to <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> if you later want to stop the metronome from being affected by these MIDI messages.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L754">view source</a></div></div><div class="public anchor" id="var-add-midi-control-metronome-reset-mapping"><h3>add-midi-control-metronome-reset-mapping</h3><div class="usage"><code>(add-midi-control-metronome-reset-mapping device-filter channel control-number &amp; {:keys [metronome], :or {metronome (:metronome *show*)}})</code></div><div class="doc"><div class="markdown"><p>Cause a metronome to be reset to beat 1, bar 1, phrase 1 when a control-change message with non-zero value is received from the specified <code>device</code>, <code>channel</code>, and <code>control-number</code>.</p>
<p>The first MIDI input source whose device matches the <code>device-filter</code> (using <a href="afterglow.midi.html#var-filter-devices">filter-devices</a>) will be chosen.</p>
<p>If keyword parameter <code>:metronome</code> is supplied, its value can either be a <a href="afterglow.rhythm.html#var-metronome">rhythm/metronome</a> object, or a keyword naming a show variable containing such an object. If not supplied, the main metronome attached to <a href="afterglow.show-context.html#var-*show*">*show*</a> is mapped.</p>
<p>Returns a MIDI mapping function which can be passed to <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> if you later want to stop the metronome from being affected by these MIDI messages.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L687">view source</a></div></div><div class="public anchor" id="var-add-midi-control-to-master-mapping"><h3>add-midi-control-to-master-mapping</h3><div class="usage"><code>(add-midi-control-to-master-mapping device-filter channel control-number &amp; {:keys [master min max], :or {master (:grand-master *show*), min 0, max 100}})</code></div><div class="doc"><div class="markdown"><p>Cause the specified <a href="afterglow.effects.dimmer.html#var-master">dimmer/master</a> in <a href="afterglow.show-context.html#var-*show*">*show*</a> to be updated by any MIDI controller-change messages from the specified device sent on the specified <code>channel</code> and <code>control-number</code>.</p>
<p>The first MIDI input source whose device matches the <code>device-filter</code> (using <a href="afterglow.midi.html#var-filter-devices">filter-devices</a>) will be chosen.</p>
<p>If <code>:min</code> and/or <code>:max</code> are specified, they will be used instead of the normal master range of 0 to 100. If given, both <code>:min</code> and <code>:max</code> must be valid percentages (in the range 0 to 100). If no <code>:master</code> is supplied, the show’s grand master is mapped. If the value supplied with <code>:master</code> is a keyword, it is resolved as a show variable containing a dimmer master.</p>
<p>Returns a MIDI mapping function which can be passed to <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> if you later want to stop the dimmer master from being affected by these MIDI messages.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L620">view source</a></div></div><div class="public anchor" id="var-add-midi-control-to-var-mapping"><h3>add-midi-control-to-var-mapping</h3><div class="usage"><code>(add-midi-control-to-var-mapping device-filter channel control-number variable &amp; {:keys [min max transform-fn], :or {min 0, max 127}})</code></div><div class="doc"><div class="markdown"><p>Cause the specified <code>variable</code> in <a href="afterglow.show-context.html#var-*show*">*show*</a> to be updated by any MIDI controller-change messages from the specified device sent on the specified <code>channel</code> and <code>control-number</code>.</p>
<p>The first MIDI input source whose device matches the <code>device-filter</code> (using <a href="afterglow.midi.html#var-filter-devices">filter-devices</a>) will be chosen.</p>
<p>If <code>:min</code> and/or <code>:max</code> are specified, the normal MIDI range from 0 to 127 will be scaled to the supplied range instead.</p>
<p>If <code>:transform-fn</code> is specified, it will be called with the MIDI value (after scaling, if any was specified), and its return value will be stored in the variable.</p>
<p>Returns a MIDI mapping function which can be passed to <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> if you later want to stop the variable from responding to these MIDI messages.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L565">view source</a></div></div><div class="public anchor" id="var-add-send-buffer-fn.21"><h3>add-send-buffer-fn!</h3><div class="usage"><code>(add-send-buffer-fn! f)</code></div><div class="doc"><div class="markdown"><p>Arranges for the supplied function to be called when the Afterglow rendering loop is sending the DMX data for a frame of lighting effects. The function must take no arguments.</p>
<p>This is how custom assigner types which do not result in DMX data, such as the Pangolin <a href="afterglow.beyond.html#var-beyond-server">beyond-server</a> laser show integration, register their extension functions to participate in the rendering loop.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L287">view source</a></div></div><div class="public anchor" id="var-add-variable-set-fn.21"><h3>add-variable-set-fn!</h3><div class="usage"><code>(add-variable-set-fn! key f)</code></div><div class="doc"><div class="markdown"><p>Arranges for the supplied function to be called when the the show variable with the specified keyword is set. The function will be called with two arguments: the keyword, and the new value which is being set.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L524">view source</a></div></div><div class="public anchor" id="var-address-map"><h3>address-map</h3><div class="usage"><code>(address-map)</code></div><div class="doc"><div class="markdown"><p>Returns a sorted map whose keys are the IDs of the universes managed by <a href="afterglow.show-context.html#var-*show*">*show*</a>, and whose values are address maps for the corresponding universe. The address maps have keys for every channel in use by the show in that universe, and the value is the key of the fixture using that address.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1014">view source</a></div></div><div class="public anchor" id="var-all-fixtures"><h3>all-fixtures</h3><div class="usage"><code>(all-fixtures)</code></div><div class="doc"><div class="markdown"><p>Returns all fixtures patched into <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1145">view source</a></div></div><div class="public anchor" id="var-blackout-show"><h3>blackout-show</h3><div class="usage"><code>(blackout-show)</code></div><div class="doc"><div class="markdown"><p>Sends zero to every channel of every universe associated with <a href="afterglow.show-context.html#var-*show*">*show*</a>. Will quickly be overwritten if the show is running and there are any active effects, so this is mostly useful when a show has been suspended and you want to darken the lights it left on.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L468">view source</a></div></div><div class="public anchor" id="var-blackout-universe"><h3>blackout-universe</h3><div class="usage"><code>(blackout-universe universe)</code></div><div class="doc"><div class="markdown"><p>Sends zero to every channel of the specified universe. Will be quickly overwritten if there are any active shows transmitting to that universe.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L459">view source</a></div></div><div class="public anchor" id="var-clear-effects.21"><h3>clear-effects!</h3><div class="usage"><code>(clear-effects!)</code></div><div class="doc"><div class="markdown"><p>Remove all effects currently active in <a href="afterglow.show-context.html#var-*show*">*show*</a>, leading to a blackout state in all controlled universes (if the show is running) until new effects are added.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L914">view source</a></div></div><div class="public anchor" id="var-clear-empty-buffer-fn.21"><h3>clear-empty-buffer-fn!</h3><div class="usage"><code>(clear-empty-buffer-fn! f)</code></div><div class="doc"><div class="markdown"><p>Ceases calling the supplied function during the buffer clearing phase of the rendering loop.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L279">view source</a></div></div><div class="public anchor" id="var-clear-frame-fn.21"><h3>clear-frame-fn!</h3><div class="usage"><code>(clear-frame-fn! f)</code></div><div class="doc"><div class="markdown"><p>Ceases calling the supplied function from the rendering loop.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L258">view source</a></div></div><div class="public anchor" id="var-clear-send-buffer-fn.21"><h3>clear-send-buffer-fn!</h3><div class="usage"><code>(clear-send-buffer-fn! f)</code></div><div class="doc"><div class="markdown"><p>Ceases calling the supplied function during the data sending phase of the rendering loop.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L301">view source</a></div></div><div class="public anchor" id="var-clear-variable-set-fn.21"><h3>clear-variable-set-fn!</h3><div class="usage"><code>(clear-variable-set-fn! key f)</code></div><div class="doc"><div class="markdown"><p>Ceases calling the supplied function when the show variable with the specified keyword is set.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L534">view source</a></div></div><div class="public anchor" id="var-current-load"><h3>current-load</h3><div class="usage"><code>(current-load)</code></div><div class="doc"><div class="markdown"><p>Returns a sense of how much headroom there is running the current effects, in the form of the fraction of the available refresh interval that was used calculating and sending the last several frames.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L150">view source</a></div></div><div class="public anchor" id="var-default-refresh-interval"><h3>default-refresh-interval</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>How often should frames of DMX data be sent out; this should be a supported frame rate for your interface. The default here is 40 Hz, forty frames per second.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L50">view source</a></div></div><div class="public anchor" id="var-end-effect.21"><h3>end-effect!</h3><div class="usage"><code>(end-effect! key &amp; {:keys [force when-id]})</code></div><div class="doc"><div class="markdown"><p>Shut down an effect that is running in <a href="afterglow.show-context.html#var-*show*">*show*</a>. Unless a <code>true</code> value is passed for <code>:force</code>, this is done by asking the effect to end (and waiting until it reports completion); forcibly stopping it simply immediately removes it from the show. If an id is specified with <code>:when-id</code>, the effect will only be ended if the id of the currently-running effect matches the one supplied. If it was created from a cue grid, notify any controllers that might be tracking the cue state.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L886">view source</a></div></div><div class="public anchor" id="var-find-cue-grid-active-effect"><h3>find-cue-grid-active-effect</h3><div class="usage"><code>(find-cue-grid-active-effect show x y)</code></div><div class="doc"><div class="markdown"><p>Find the cue at a particular cue grid location. If it is marked as active, check whether there is still an effect running under that key with the same id. If so, return a vector containing both the cue and the effect. If not, mark the cue as inactive, and return a vector containing the cue and nil. If no cue was found at all, simply returns nil.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L986">view source</a></div></div><div class="public anchor" id="var-find-effect"><h3>find-effect</h3><div class="usage"><code>(find-effect key)</code></div><div class="doc"><div class="markdown"><p>Looks up the specified effect keyword in list of active effects for <a href="afterglow.show-context.html#var-*show*">*show*</a>. Returns a map of the effect metadata, with the effect itself under the key <code>:effect</code>. If the effect is in the process of ending, the keyword <code>:ending</code> will have a <code>true</code> value.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L775">view source</a></div></div><div class="public anchor" id="var-fixtures-named"><h3>fixtures-named</h3><div class="usage"><code>(fixtures-named n)</code></div><div class="doc"><div class="markdown"><p>Returns all fixtures patched into <a href="afterglow.show-context.html#var-*show*">*show*</a> whose key matches the specified name, with an optional number following it, as would be assigned to a fixture group by <a href="null">patch-fixtures!</a></p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1151">view source</a></div></div><div class="public anchor" id="var-get-variable"><h3>get-variable</h3><div class="usage"><code>(get-variable key)</code></div><div class="doc"><div class="markdown"><p>Get the value of a variable associated with <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L559">view source</a></div></div><div class="public anchor" id="var-ola-failure-description"><h3>ola-failure-description</h3><div class="usage"><code>(ola-failure-description)</code></div><div class="doc"><div class="markdown"><p>If the last attempt to communicate with the OLA daemon failed, returns a description of the problem, otherwise returns nil.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L61">view source</a></div></div><div class="public anchor" id="var-patch-fixture.21"><h3>patch-fixture!</h3><div class="usage"><code>(patch-fixture! key fixture universe start-address &amp; {:keys [x y z x-rotation y-rotation z-rotation], :or {x 0.0, y 0.0, z 0.0, x-rotation 0.0, y-rotation 0.0, z-rotation 0.0}})</code></div><div class="doc"><div class="markdown"><p>Patch a fixture to a universe in <a href="afterglow.show-context.html#var-*show*">*show*</a> at a starting DMX channel address, at a particular point in space, with a particular orientation.</p>
<p><code>key</code> is a keyword identifying the fixture. If you need to remove the fixture later, or re-patch it with different parameters, you can do that by passing the same keyword to <a href="afterglow.show.html#var-remove-fixture.21">remove-fixture!</a> or <code>patch-fixture!</code>. If you have a set of fixtures that you want to be able to easily group, give them keywords that start with the same name, followed by a hyphen and uniqe numbers. That way, if you pass the name portion (everthing before the final hyphen and number) to <a href="afterglow.show.html#var-fixtures-named">fixtures-named</a>, you will get back a list of all those fixtures.</p>
<p><code>fixture</code> is a <a href="https://github.com/brunchboy/afterglow/blob/master/doc/fixture_definitions.adoc#fixture-definitions">Fixture Definition map</a> which specifies all the capabilities of the fixture and how Afterglow can control it.</p>
<p><code>universe</code> identifies which DMX universe the fixture is attached to, and must be one of the universe numbers that was passed in the <code>universes</code> argument to <a href="afterglow.show.html#var-show">show</a> when creating the show. <code>start-address</code> identifies the DMX address of the first channel the fixture is listening to in that universe (it will be displayed on the fixture’s configuration panel or DIP switches), and is an integer ranging from <code>1</code> to <code>512</code>, the legal DMX addresses in a universe. The attempt to patch will fail if there are more channels in the fixture definition than fit within the 512-channel address space starting at that address, or if any of the addresses used by the fixture have already been assigned to other patched fixtures.</p>
<p>Coordinates and rotations are optional, expressed along with the keyword arguments <code>:x</code>, <code>:y</code>, <code>:z</code>, <code>:x-rotation</code>, <code>:y-rotation</code>, and <code>:z-rotation</code>, which all default to zero if not specified. All coordinates and rotations are interpreted with respect to the <a href="https://github.com/brunchboy/afterglow/blob/master/doc/show_space.adoc#show-space">show frame of reference</a>, and are in meters and radians. You can use <a href="afterglow.transform.html#var-inches">transform/inches</a>, <a href="afterglow.transform.html#var-feet">transform/feet</a> and <a href="afterglow.transform.html#var-degrees">transform/degrees</a> to convert those units for you if desired.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1075">view source</a></div></div><div class="public anchor" id="var-patch-fixture-group.21"><h3>patch-fixture-group!</h3><h4 class="deprecated">deprecated in 0.1.2</h4><div class="usage"><code>(patch-fixture-group! key fixture universe start-address count)</code><code>(patch-fixture-group! key fixture universe start-address count offset)</code></div><div class="doc"><div class="markdown"><p><em>Deprecated until it supports positioning each fixture.</em></p>
<p>Patch a fixture group to a universe in <a href="afterglow.show-context.html#var-*show*">*show*</a> at a starting DMX channel address. Names will be assigned by adding a hyphen and numeric suffix, starting with 1, to the key supplied. If an offset is supplied, it will be added to the starting address for each subsequent fixture; if not, the largest offset used by the fixture will be used to calculate a suitable offset.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1127">view source</a></div></div><div class="public anchor" id="var-profile-show"><h3>profile-show</h3><div class="usage"><code>(profile-show &amp; {:keys [iterations serial?], :or {iterations 100, serial? true}})</code></div><div class="doc"><div class="markdown"><p>Gather statistics about the performance of generating and sending a frame of DMX data to the universes <a href="afterglow.show-context.html#var-*show*">*show*</a>. The show must be stopped to run this function since it manipulates the thread pool atom to run the kind of test requested.</p>
<p>Specify the number of iterations of the rendering loop that should be profiled with the optional keyword argument <code>:iterations</code> (which defaults to 100). Assumes you want to profile without the use of a thread pool to look for worst-case performance unless you pass <code>false</code> with the optional keyword argument <code>:serial?</code>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1171">view source</a></div></div><div class="public anchor" id="var-register-grid-controller"><h3>register-grid-controller</h3><div class="usage"><code>(register-grid-controller controller)</code></div><div class="doc"><div class="markdown"><p>Add a cue grid controller to the list available for linking in the web interface. The argument must implement the <a href="afterglow.controllers.html#var-IGridController">IGridController</a> protocol.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1191">view source</a></div></div><div class="public anchor" id="var-register-show"><h3>register-show</h3><div class="usage"><code>(register-show show description)</code></div><div class="doc"><div class="markdown"><p>Add a show to the list of available shows in the web interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L389">view source</a></div></div><div class="public anchor" id="var-remove-fixture.21"><h3>remove-fixture!</h3><div class="usage"><code>(remove-fixture! key)</code></div><div class="doc"><div class="markdown"><p>Remove a fixture from thosed patched into <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1025">view source</a></div></div><div class="public anchor" id="var-remove-midi-control-metronome-mapping"><h3>remove-midi-control-metronome-mapping</h3><h4 class="deprecated">deprecated in 0.2.0</h4><div class="usage"><code>(remove-midi-control-metronome-mapping device-filter channel control-number f &amp; {:keys [metronome], :or {metronome (:metronome *show*)}})</code></div><div class="doc"><div class="markdown"><p>Deprecated: There is no reason to use this function, it is simpler to call <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> directly.</p>
<p>Stop affecting a metronome when the specified MIDI controller-change messages are received. This undoes the effect of any of <a href="afterglow.show.html#var-add-midi-control-metronome-reset-mapping">add-midi-control-metronome-reset-mapping</a>, <a href="afterglow.show.html#var-add-midi-control-metronome-align-bar-mapping">add-midi-control-metronome-align-bar-mapping</a>, and <a href="afterglow.show.html#var-add-midi-control-metronome-align-phrase-mapping">add-midi-control-metronome-align-phrase-mapping</a>.</p>
<p>If keyword parameter <code>:metronome</code> is supplied, its value can either be a <a href="afterglow.rhythm.html#var-metronome">rhythm/metronome</a> object, or a keyword naming a show variable containing such an object. If not supplied, the main metronome attached to <a href="afterglow.show-context.html#var-*show*">*show*</a> is mapped.</p>
<p><code>f</code> is the function that was returned by <a href="afterglow.show.html#var-add-midi-control-metronome-reset-mapping">add-midi-control-metronome-reset-mapping</a>, <a href="afterglow.show.html#var-add-midi-control-metronome-align-bar-mapping">add-midi-control-metronome-align-bar-mapping</a>, or <a href="afterglow.show.html#var-add-midi-control-metronome-align-phrase-mapping">add-midi-control-metronome-align-phrase-mapping</a> when this relationship was established.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L707">view source</a></div></div><div class="public anchor" id="var-remove-midi-control-to-master-mapping"><h3>remove-midi-control-to-master-mapping</h3><h4 class="deprecated">deprecated in 0.2.0</h4><div class="usage"><code>(remove-midi-control-to-master-mapping device-filter channel control-number f &amp; {:keys [master], :or {master (:grand-master *show*)}})</code></div><div class="doc"><div class="markdown"><p>Deprecated: There is no reason to use this function, it is simpler to call <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> directly.</p>
<p>Cease updating the specified <a href="afterglow.effects.dimmer.html#var-master">dimmer/master</a> when the specified MIDI controller-change messages are received. <code>f</code> is the function that was returned by <a href="afterglow.show.html#var-add-midi-control-to-master-mapping">add-midi-control-to-master-mapping</a> when this relationship was established.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L653">view source</a></div></div><div class="public anchor" id="var-remove-midi-control-to-var-mapping"><h3>remove-midi-control-to-var-mapping</h3><h4 class="deprecated">deprecated in 0.2.0</h4><div class="usage"><code>(remove-midi-control-to-var-mapping device-filter channel control-number variable f)</code></div><div class="doc"><div class="markdown"><p>Deprecated: There is no reason to use this function, it is simpler to call <a href="afterglow.midi.html#var-remove-control-mapping">remove-control-mapping</a> directly.</p>
<p>Cease updating the specified variable in <a href="afterglow.show-context.html#var-*show*">*show*</a> when the specified MIDI controller-change messages are received. <code>f</code> is the function that was returned by <a href="afterglow.show.html#var-add-midi-control-to-var-mapping">add-midi-control-to-var-mapping</a> when this relationship was created.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L606">view source</a></div></div><div class="public anchor" id="var-resolution-order"><h3>resolution-order</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The order in which assigners should be evaluated, by type key. Multi-channel assignments are resolved before individual ones.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L67">view source</a></div></div><div class="public anchor" id="var-running.3F"><h3>running?</h3><div class="usage"><code>(running?)</code></div><div class="doc"><div class="markdown"><p>Returns an indication of whether the show is currently generating and sending values to its associated lighting universes.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L359">view source</a></div></div><div class="public anchor" id="var-set-extension-resolution-order.21"><h3>set-extension-resolution-order!</h3><div class="usage"><code>(set-extension-resolution-order! extension-key order)</code></div><div class="doc"><div class="markdown"><p>A system wanting to extend the Afterglow rendering loop to support new kinds of assigners must call this function to register its new unique assigner types, and the order in which they should be run.</p>
<p>The first argument <code>extension-key</code> is a unique keyword identifying the extension, for example a keyword created from its namespace name. The second argument is a vector containing all the keywords which identify the new assigner types which are implemented by the extension. These must also be globally unique, and should probably have a prefix related to the exension name.</p>
<p>Even if the extension adds only a single new assigner type, that must be passed as a single-element vector in <code>order</code> so that Afterglow knows to look for and run its assigners.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L86">view source</a></div></div><div class="public anchor" id="var-set-variable.21"><h3>set-variable!</h3><div class="usage"><code>(set-variable! key newval)</code></div><div class="doc"><div class="markdown"><p>Set a value for a variable associated with <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L547">view source</a></div></div><div class="public anchor" id="var-show"><h3>show</h3><div class="usage"><code>(show &amp; {:keys [universes base-metronome refresh-interval description], :or {universes [1], base-metronome (rhythm/metronome 120), refresh-interval default-refresh-interval}})</code></div><div class="doc"><div class="markdown"><p>Create a show coordinator to calculate and send DMX values to the specified universe(s), with a <a href="afterglow.rhythm.html#var-metronome">rhythm/metronome</a> to coordinate timing. The metronome to use can be specified with the optional keyword argument <code>:base-metronome</code>; otherwise, a new metronome is created for the show, with a starting <code>bpm</code> of 120.</p>
<p>Values are computed and sent at a fixed refresh interval (in milliseconds), which defaults to a frame rate of thirty times per second, but can be specified using the optional keyword argument <code>:refresh-interval</code>.</p>
<p>If a description is supplied with the <code>:description</code> argument, the show will be registered under that description for the user to choose in the embedded web interface. If you recreate the show because you are in the process of working out its details, be sure to unregister the old version (with <a href="afterglow.show.html#var-unregister-show">unregister-show</a>) first, or you will end up with multiple shows with the same description in the web interface. There is an example of how to handle this automatically at the start of <a href="afterglow.examples.html#var-use-sample-show">afterglow.examples/use-sample-show</a> (click the <code>view source</code> link below the description to see the <code>sample-show</code> atom and <code>swap!</code> invocation within <code>set-default-show!</code> it uses to make sure there is only ever one version registered).</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L402">view source</a></div></div><div class="public anchor" id="var-shows"><h3>shows</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Holds the registered shows, if any, for display in the web server.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L386">view source</a></div></div><div class="public anchor" id="var-start.21"><h3>start!</h3><div class="usage"><code>(start!)</code></div><div class="doc"><div class="markdown"><p>Starts (or restarts) a scheduled task to calculate and send DMX values to the universes controlled by <a href="afterglow.show-context.html#var-*show*">*show*</a> at the appropriate refresh rate.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L366">view source</a></div></div><div class="public anchor" id="var-stop.21"><h3>stop!</h3><div class="usage"><code>(stop!)</code></div><div class="doc"><div class="markdown"><p>Shuts down and removes the scheduled task which is sending DMX values for <a href="afterglow.show-context.html#var-*show*">*show*</a>, and cleans up the show’s thread pool.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L343">view source</a></div></div><div class="public anchor" id="var-stop-all.21"><h3>stop-all!</h3><div class="usage"><code>(stop-all!)</code></div><div class="doc"><div class="markdown"><p>Stops all running shows. Afterglow registers a shutdown hook to call this when the Java environment is shutting down, to clean up gracefully.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L479">view source</a></div></div><div class="public anchor" id="var-sync-status"><h3>sync-status</h3><div class="usage"><code>(sync-status)</code></div><div class="doc"><div class="markdown"><p>Checks what kind of synchronization is in effect for <a href="afterglow.show-context.html#var-*show*">*show*</a>, and reports on how it seems to be working.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L515">view source</a></div></div><div class="public anchor" id="var-sync-to-external-clock"><h3>sync-to-external-clock</h3><div class="usage"><code>(sync-to-external-clock)</code><code>(sync-to-external-clock sync-fn)</code></div><div class="doc"><div class="markdown"><p>Stops or sarts synchronizing the show metronome attached to <a href="afterglow.show-context.html#var-*show*">*show*</a> with an external clock source. Pass it a function which takes the metronome and binds it to the source, returning a ClockSync object which will be stored with the show, so synchronization can later be stopped if desired. Calling this stops any synchronization that was formerly in effect, and calling it with no sync-fn argument simply leaves it stopped.</p>
<p>Functions useful to pass to this include <a href="afterglow.midi.html#var-sync-to-midi-clock">midi/sync-to-midi-clock</a> and <a href="afterglow.dj-link.html#var-sync-to-dj-link">dj-link/sync-to-dj-link</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L496">view source</a></div></div><div class="public anchor" id="var-unregister-grid-controller"><h3>unregister-grid-controller</h3><div class="usage"><code>(unregister-grid-controller controller)</code></div><div class="doc"><div class="markdown"><p>Remove a cue grid controller from the list available for linking in the web interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L1199">view source</a></div></div><div class="public anchor" id="var-unregister-show"><h3>unregister-show</h3><div class="usage"><code>(unregister-show show)</code></div><div class="doc"><div class="markdown"><p>Remove a show from the list of available shows in the web interface.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/show.clj#L395">view source</a></div></div></div></body></html>