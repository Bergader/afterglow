<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.rhythm documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Afterglow</span> <span class="project-version">0.2.1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.beyond.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beyond</span></div></a></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mini</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-pro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-pro</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.tempo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tempo</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.coremidi4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coremidi4j</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.cues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cues</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-3"><a href="afterglow.effects.show-variable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-variable</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.american-dj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>american-dj</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.qxf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qxf</span></div></a></li><li class="depth-2 branch"><a href="afterglow.init.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch current"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shows</span></div></div></li><li class="depth-3"><a href="afterglow.shows.sallie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sallie</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="afterglow.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.show-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-control</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.web-repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web-repl</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.rhythm.html#var--.3EMetronome"><div class="inner"><span>-&gt;Metronome</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var--.3EMetronomeSnapshot"><div class="inner"><span>-&gt;MetronomeSnapshot</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-beat-ms"><div class="inner"><span>beat-ms</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-enhanced-phase"><div class="inner"><span>enhanced-phase</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-IMetronome"><div class="inner"><span>IMetronome</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-add-bpm-watch"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-add-bpm-watch</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-adjust"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-adjust</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-bar"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-bar</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-bar-phase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-bar-phase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-bar-start"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-bar-start</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-beat"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-beat</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-beat-phase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-beat-phase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-bpb"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-bpb</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-bpm"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-bpm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-bpp"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-bpp</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-ding"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-ding</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-marker"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-marker</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-phrase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-phrase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-phrase-phase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-phrase-phase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-phrase-start"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-phrase-start</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-remove-bpm-watch"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-remove-bpm-watch</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-snapshot"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-snapshot</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-start"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-start</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-metro-tick"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-tick</span></div></a></li><li class="depth-2"><a href="afterglow.rhythm.html#var-metro-tock"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metro-tock</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-ISnapshot"><div class="inner"><span>ISnapshot</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-bar-phase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-bar-phase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-bar-within-phrase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-bar-within-phrase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-beat-phase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-beat-phase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-beat-within-bar"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-beat-within-bar</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-beat-within-phrase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-beat-within-phrase</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-down-beat.3F"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-down-beat?</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-marker"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-marker</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html#var-snapshot-phrase-phase"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-phrase-phase</span></div></a></li><li class="depth-2"><a href="afterglow.rhythm.html#var-snapshot-phrase-start.3F"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>snapshot-phrase-start?</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-map-.3EMetronome"><div class="inner"><span>map-&gt;Metronome</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-map-.3EMetronomeSnapshot"><div class="inner"><span>map-&gt;MetronomeSnapshot</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-marker-number"><div class="inner"><span>marker-number</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-marker-phase"><div class="inner"><span>marker-phase</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-metronome"><div class="inner"><span>metronome</span></div></a></li><li class="depth-1"><a href="afterglow.rhythm.html#var-normalize-phase"><div class="inner"><span>normalize-phase</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">afterglow.rhythm</h1><div class="doc"><div class="markdown"><p>Functions to help work with musical time, evolved from the original version in <a href="https://github.com/overtone/overtone/blob/master/src/overtone/music/rhythm.clj">Overtone</a>.</p></div></div><div class="public anchor" id="var--.3EMetronome"><h3>-&gt;Metronome</h3><div class="usage"><code>(-&gt;Metronome start bpm bpb bpp)</code></div><div class="doc"><div class="markdown"><p>Positional factory function for class afterglow.rhythm.Metronome.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L211">view source</a></div></div><div class="public anchor" id="var--.3EMetronomeSnapshot"><h3>-&gt;MetronomeSnapshot</h3><div class="usage"><code>(-&gt;MetronomeSnapshot start bpm bpb bpp instant beat bar phrase beat-phase bar-phase phrase-phase)</code></div><div class="doc"><div class="markdown"><p>Positional factory function for class afterglow.rhythm.MetronomeSnapshot.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L174">view source</a></div></div><div class="public anchor" id="var-beat-ms"><h3>beat-ms</h3><div class="usage"><code>(beat-ms b bpm)</code></div><div class="doc"><div class="markdown"><p>Convert <code>b</code> beats to milliseconds at the given <code>bpm</code>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L138">view source</a></div></div><div class="public anchor" id="var-enhanced-phase"><h3>enhanced-phase</h3><div class="usage"><code>(enhanced-phase marker phase desired-ratio)</code></div><div class="doc"><div class="markdown"><p>Calculate a phase with respect to multiples or fractions of a marker (beat, bar, or phrase), given the <code>phase</code> with respect to that marker, the number of that <code>marker</code>, and the desired ratio. A <code>desired-ratio</code> of 1 returns the phase unchanged; 1/2 oscillates twice as fast, 3/4 oscillates 4 times every three markers…</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L158">view source</a></div></div><div class="public anchor" id="var-IMetronome"><h3>IMetronome</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A time-keeping tool for music-related systems.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-metro-add-bpm-watch"><h3>metro-add-bpm-watch</h3><div class="usage"><code>(metro-add-bpm-watch metro key f)</code></div><div class="doc"><div class="markdown"><p>Register a function to be called whenever the metronome’s BPM changes. The <code>key</code> and <code>function</code> arguments are the same as found in <a href="http://clojuredocs.org/clojure.core/add-watch">clojure.core/add-watch</a>, and in fact are passed on to it.</p></div></div></div><div class="public anchor" id="var-metro-adjust"><h3>metro-adjust</h3><div class="usage"><code>(metro-adjust metro ms)</code></div><div class="doc"><div class="markdown"><p>Adds a number of milliseconds to the start time of the metronome.</p></div></div></div><div class="public anchor" id="var-metro-bar"><h3>metro-bar</h3><div class="usage"><code>(metro-bar metro)</code><code>(metro-bar metro bar)</code></div><div class="doc"><div class="markdown"><p>Returns the next bar number or the timestamp (in milliseconds) of the given <code>bar</code>.</p></div></div></div><div class="public anchor" id="var-metro-bar-phase"><h3>metro-bar-phase</h3><div class="usage"><code>(metro-bar-phase metro)</code><code>(metro-bar-phase metro phase)</code></div><div class="doc"><div class="markdown"><p>Returns the distance traveled into the current bar as a phase number ranging from [0.0, 1.0), or adjusts the phase to match the one supplied.</p></div></div></div><div class="public anchor" id="var-metro-bar-start"><h3>metro-bar-start</h3><div class="usage"><code>(metro-bar-start metro start-bar)</code></div><div class="doc"><div class="markdown"><p>Restarts the metronome at <code>start-bar</code>, keeping the beat phase unchanged in case it is being synced to an external source.</p></div></div></div><div class="public anchor" id="var-metro-beat"><h3>metro-beat</h3><div class="usage"><code>(metro-beat metro)</code><code>(metro-beat metro beat)</code></div><div class="doc"><div class="markdown"><p>Returns the next beat number or the timestamp (in milliseconds) of the given <code>beat</code>.</p></div></div></div><div class="public anchor" id="var-metro-beat-phase"><h3>metro-beat-phase</h3><div class="usage"><code>(metro-beat-phase metro)</code><code>(metro-beat-phase metro phase)</code></div><div class="doc"><div class="markdown"><p>Returns the distance traveled into the current beat as a phase number ranging from [0.0, 1.0), or adjusts the phase to match the one supplied.</p></div></div></div><div class="public anchor" id="var-metro-bpb"><h3>metro-bpb</h3><div class="usage"><code>(metro-bpb metro)</code><code>(metro-bpb metro new-bpb)</code></div><div class="doc"><div class="markdown"><p>Get the current beats per bar or change it to <code>new-bpb</code></p></div></div></div><div class="public anchor" id="var-metro-bpm"><h3>metro-bpm</h3><div class="usage"><code>(metro-bpm metro)</code><code>(metro-bpm metro new-bpm)</code></div><div class="doc"><div class="markdown"><p>Get the current bpm or change the bpm to <code>new-bpm</code>.</p></div></div></div><div class="public anchor" id="var-metro-bpp"><h3>metro-bpp</h3><div class="usage"><code>(metro-bpp metro)</code><code>(metro-bpp metro new-bpp)</code></div><div class="doc"><div class="markdown"><p>Get the current bars per phrase, or change it to <code>new-bpp</code></p></div></div></div><div class="public anchor" id="var-metro-ding"><h3>metro-ding</h3><div class="usage"><code>(metro-ding metro)</code></div><div class="doc"><div class="markdown"><p>Returns the duration of one phrase in milliseconds.</p></div></div></div><div class="public anchor" id="var-metro-marker"><h3>metro-marker</h3><div class="usage"><code>(metro-marker metro)</code></div><div class="doc"><div class="markdown"><p>Returns the current time as <code>"phrase.bar.beat"</code></p></div></div></div><div class="public anchor" id="var-metro-phrase"><h3>metro-phrase</h3><div class="usage"><code>(metro-phrase metro)</code><code>(metro-phrase metro phrase)</code></div><div class="doc"><div class="markdown"><p>Returns the next phrase number or the timestamp (in milliseconds) of the given <code>phrase</code>.</p></div></div></div><div class="public anchor" id="var-metro-phrase-phase"><h3>metro-phrase-phase</h3><div class="usage"><code>(metro-phrase-phase metro)</code><code>(metro-phrase-phase metro phase)</code></div><div class="doc"><div class="markdown"><p>Returns the distance traveled into the current phrase as a phase number ranging from [0.0, 1.0), or adjusts the phase to match the one supplied.</p></div></div></div><div class="public anchor" id="var-metro-phrase-start"><h3>metro-phrase-start</h3><div class="usage"><code>(metro-phrase-start metro start-phrase)</code></div><div class="doc"><div class="markdown"><p>Restarts the metronome at <code>start-phrase</code>, keeping the beat phase unchanged in case it is being synced to an external source.</p></div></div></div><div class="public anchor" id="var-metro-remove-bpm-watch"><h3>metro-remove-bpm-watch</h3><div class="usage"><code>(metro-remove-bpm-watch metro key)</code></div><div class="doc"><div class="markdown"><p>Stop calling the function which was registered with the specified <code>key</code>.</p></div></div></div><div class="public anchor" id="var-metro-snapshot"><h3>metro-snapshot</h3><div class="usage"><code>(metro-snapshot metro)</code><code>(metro-snapshot metro instant)</code></div><div class="doc"><div class="markdown"><p>Take a snapshot of the current beat, bar, phrase, and phase state. If <code>instant</code> is supplied, calculates a snapshot for the corresponding time rather than the current time.</p></div></div></div><div class="public anchor" id="var-metro-start"><h3>metro-start</h3><div class="usage"><code>(metro-start metro)</code><code>(metro-start metro start-beat)</code></div><div class="doc"><div class="markdown"><p>Returns the start time of the metronome. Also restarts the metronome at <code>start-beat</code> if given.</p></div></div></div><div class="public anchor" id="var-metro-tick"><h3>metro-tick</h3><div class="usage"><code>(metro-tick metro)</code></div><div class="doc"><div class="markdown"><p>Returns the duration of one beat in milleseconds.</p></div></div></div><div class="public anchor" id="var-metro-tock"><h3>metro-tock</h3><div class="usage"><code>(metro-tock metro)</code></div><div class="doc"><div class="markdown"><p>Returns the duration of one bar in milliseconds.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L13">view source</a></div></div><div class="public anchor" id="var-ISnapshot"><h3>ISnapshot</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A snapshot to support a series of beat and phase calculations with respect to a given instant in time. Used by Afterglow so that all phase computations performed when updating a frame of DMX data have a consistent sense of when they are being run, to avoid, for example, half the lights acting as if they are at the very end of a beat while the rest are at the beginning of the next beat, due to a fluke in timing as their evaluation occurs over time. Snapshots also extend the notions of beat phase to enable oscillators with frequencies that are fractions or multiples of a beat.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-snapshot-bar-phase"><h3>snapshot-bar-phase</h3><div class="usage"><code>(snapshot-bar-phase snapshot)</code><code>(snapshot-bar-phase snapshot bar-ratio)</code></div><div class="doc"><div class="markdown"><p>Determine the metronome’s phase at the time of the snapshot with respect to a multiple or fraction of bars. Calling this with a <code>bar-ratio</code> of 1 (the default if not provided) is equivalent to <a href="afterglow.rhythm.html#var-metro-bar-phase">metro-bar-phase</a>, calling with a <code>bar-ratio</code> equal to <a href="afterglow.rhythm.html#var-metro-bpp">metro-bpp</a> is equivalent to <a href="afterglow.rhythm.html#var-metro-phrase-phase">metro-phrase-phase</a>, 1/2 oscillates twice as fast as 1, 3/4 oscillates 4 times every three bars… Phases range from [0-1).</p></div></div></div><div class="public anchor" id="var-snapshot-bar-within-phrase"><h3>snapshot-bar-within-phrase</h3><div class="usage"><code>(snapshot-bar-within-phrase snapshot)</code></div><div class="doc"><div class="markdown"><p>Returns the bar number within the snapshot relative to the start of the phrase: Ranges from 1 to the value returned by <a href="afterglow.rhythm.html#var-metro-bpp">metro-bpp</a> for the metronome.</p></div></div></div><div class="public anchor" id="var-snapshot-beat-phase"><h3>snapshot-beat-phase</h3><div class="usage"><code>(snapshot-beat-phase snapshot)</code><code>(snapshot-beat-phase snapshot beat-ratio)</code></div><div class="doc"><div class="markdown"><p>Determine the metronome’s phase at the time of the snapshot with respect to a multiple or fraction of beats. Calling this with a <code>beat-ratio</code> of 1 (the default if not provided) is equivalent to <a href="afterglow.rhythm.html#var-metro-beat-phase">metro-beat-phase</a>, calling with a <code>beat-ratio</code> equal to <a href="afterglow.rhythm.html#var-metro-bpb">metro-bpb</a> is equivalent to <a href="afterglow.rhythm.html#var-metro-bar-phase">metro-bar-phase</a>, 1/2 oscillates twice as fast as 1, 3/4 oscillates 4 times every three beats… Phases range from [0-1).</p></div></div></div><div class="public anchor" id="var-snapshot-beat-within-bar"><h3>snapshot-beat-within-bar</h3><div class="usage"><code>(snapshot-beat-within-bar snapshot)</code></div><div class="doc"><div class="markdown"><p>Returns the beat number within the snapshot relative to the start of the bar: The down beat is 1, and the range goes up to the value returned by <a href="afterglow.rhythm.html#var-metro-bpb">metro-bpb</a> for the metronome.</p></div></div></div><div class="public anchor" id="var-snapshot-beat-within-phrase"><h3>snapshot-beat-within-phrase</h3><div class="usage"><code>(snapshot-beat-within-phrase snapshot)</code></div><div class="doc"><div class="markdown"><p>Returns the beat number within the snapshot relative to the start of the phrase: The first beat is 1, and the range goes up to the values returned by <a href="afterglow.rhythm.html#var-metro-bpb">metro-bpb</a> times <a href="afterglow.rhythm.html#var-metro-bpp">metro-bpp</a> for the metronome.</p></div></div></div><div class="public anchor" id="var-snapshot-down-beat.3F"><h3>snapshot-down-beat?</h3><div class="usage"><code>(snapshot-down-beat? snapshot)</code></div><div class="doc"><div class="markdown"><p>True if the current beat at the time of the snapshot was the first beat in its bar.</p></div></div></div><div class="public anchor" id="var-snapshot-marker"><h3>snapshot-marker</h3><div class="usage"><code>(snapshot-marker snapshot)</code></div><div class="doc"><div class="markdown"><p>Returns the time represented by the snapshot as <code>"phrase.bar.beat</code></p></div></div></div><div class="public anchor" id="var-snapshot-phrase-phase"><h3>snapshot-phrase-phase</h3><div class="usage"><code>(snapshot-phrase-phase snapshot)</code><code>(snapshot-phrase-phase snapshot phrase-ratio)</code></div><div class="doc"><div class="markdown"><p>Determine the metronome’s phase at the time of the snapshot with respect to a multiple or fraction of phrases. Calling this with a <code>phrase-ratio</code> of 1 (the default if not provided) is equivalent to <a href="afterglow.rhythm.html#var-metro-phrase-phase">metro-phrase-phase</a>, 1/2 oscillates twice as fast as 1, 3/4 oscillates 4 times every three bars… Phases range from [0-1).</p></div></div></div><div class="public anchor" id="var-snapshot-phrase-start.3F"><h3>snapshot-phrase-start?</h3><div class="usage"><code>(snapshot-phrase-start? snapshot)</code></div><div class="doc"><div class="markdown"><p>True if the current beat at the time of the snapshot wass the first beat in its phrase.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L74">view source</a></div></div><div class="public anchor" id="var-map-.3EMetronome"><h3>map-&gt;Metronome</h3><div class="usage"><code>(map-&gt;Metronome m__6522__auto__)</code></div><div class="doc"><div class="markdown"><p>Factory function for class afterglow.rhythm.Metronome, taking a map of keywords to field values.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L211">view source</a></div></div><div class="public anchor" id="var-map-.3EMetronomeSnapshot"><h3>map-&gt;MetronomeSnapshot</h3><div class="usage"><code>(map-&gt;MetronomeSnapshot m__6522__auto__)</code></div><div class="doc"><div class="markdown"><p>Factory function for class afterglow.rhythm.MetronomeSnapshot, taking a map of keywords to field values.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L174">view source</a></div></div><div class="public anchor" id="var-marker-number"><h3>marker-number</h3><div class="usage"><code>(marker-number instant start interval)</code></div><div class="doc"><div class="markdown"><p>Helper function to calculate the beat, bar, or phrase number in effect at a given <code>instant</code> (in milliseconds), given a starting point (<code>start</code>, also in milliseconds), and the <code>interval</code> (also in milliseconds) between beats, bars, or phrases.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L142">view source</a></div></div><div class="public anchor" id="var-marker-phase"><h3>marker-phase</h3><div class="usage"><code>(marker-phase instant start interval)</code></div><div class="doc"><div class="markdown"><p>Helper function to calculate the beat, bar, or phrase phase at a given <code>instant</code> (in millseconds), given a <code>start</code> time (also in milliseconds) and <code>interval</code> (in milliseconds).</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L150">view source</a></div></div><div class="public anchor" id="var-metronome"><h3>metronome</h3><div class="usage"><code>(metronome bpm &amp; {:keys [bpb bpp], :or {bpb 4, bpp 8}})</code></div><div class="doc"><div class="markdown"><p>A metronome is a beat management tool. Tell it what BPM you want, and it will compute beat, bar, and phrase timestamps accordingly. See the <a href="afterglow.rhythm.html#var-IMetronome">IMetronome</a> interface for full details.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L390">view source</a></div></div><div class="public anchor" id="var-normalize-phase"><h3>normalize-phase</h3><div class="usage"><code>(normalize-phase phase)</code></div><div class="doc"><div class="markdown"><p>Makes sure a phase value is in the range [0.0,1.0)</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/rhythm.clj#L204">view source</a></div></div></div></body></html>