<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.effects.params documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Afterglow</span> <span class="project-version">0.2.4</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.beyond.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beyond</span></div></a></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push-2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push-2</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mini</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-mk2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-mk2</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-pro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-pro</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.tempo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tempo</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.coremidi4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coremidi4j</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.cues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cues</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch current"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-3"><a href="afterglow.effects.show-variable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-variable</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.american-dj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>american-dj</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.qxf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qxf</span></div></a></li><li class="depth-2 branch"><a href="afterglow.init.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shows</span></div></div></li><li class="depth-3"><a href="afterglow.shows.sallie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sallie</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="afterglow.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.show-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-control</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.web-repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web-repl</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.effects.params.html#var-bind-keyword-param"><div class="inner"><span>bind-keyword-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-bind-keyword-param*"><div class="inner"><span>bind-keyword-param*</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-aim-param"><div class="inner"><span>build-aim-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-aim-transformer"><div class="inner"><span>build-aim-transformer</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-color-param"><div class="inner"><span>build-color-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-direction-param"><div class="inner"><span>build-direction-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-direction-param-from-pan-tilt"><div class="inner"><span>build-direction-param-from-pan-tilt</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-direction-transformer"><div class="inner"><span>build-direction-transformer</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-pan-tilt-param"><div class="inner"><span>build-pan-tilt-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-param-formula"><div class="inner"><span>build-param-formula</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-spatial-param"><div class="inner"><span>build-spatial-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-step-param"><div class="inner"><span>build-step-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-build-variable-param"><div class="inner"><span>build-variable-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-check-type"><div class="inner"><span>check-type</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-frame-dynamic-param.3F"><div class="inner"><span>frame-dynamic-param?</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-interpret-color"><div class="inner"><span>interpret-color</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-IParam"><div class="inner"><span>IParam</span></div></a></li><li class="depth-2 branch"><a href="afterglow.effects.params.html#var-evaluate"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>evaluate</span></div></a></li><li class="depth-2 branch"><a href="afterglow.effects.params.html#var-frame-dynamic.3F"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>frame-dynamic?</span></div></a></li><li class="depth-2 branch"><a href="afterglow.effects.params.html#var-resolve-non-frame-dynamic-elements"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resolve-non-frame-dynamic-elements</span></div></a></li><li class="depth-2"><a href="afterglow.effects.params.html#var-result-type"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>result-type</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-param.3F"><div class="inner"><span>param?</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-resolve-param"><div class="inner"><span>resolve-param</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-resolve-unless-frame-dynamic"><div class="inner"><span>resolve-unless-frame-dynamic</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-validate-optional-param-type"><div class="inner"><span>validate-optional-param-type</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-validate-param-type"><div class="inner"><span>validate-param-type</span></div></a></li><li class="depth-1"><a href="afterglow.effects.params.html#var-vector-from-pan-tilt"><div class="inner"><span>vector-from-pan-tilt</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">afterglow.effects.params</h1><div class="doc"><div class="markdown"><p>A general mechanism for passing dynamic parameters to effect functions and assigners allowing for dynamic values to be computed either when an effect creates its assigners, or when the assigners are resolving DMX values. Parameters can be calculated based on the show metronome snapshot, show variables (which can be bound to OSC and MIDI mappings), and other, not-yet-imagined things.</p></div></div><div class="public anchor" id="var-bind-keyword-param"><h3>bind-keyword-param</h3><h4 class="type">macro</h4><div class="usage"><code>(bind-keyword-param value type-expected default)</code><code>(bind-keyword-param value type-expected default param-name)</code></div><div class="doc"><div class="markdown"><p>If an input to a dynamic parameter has been passed as a keyword, treat that as a reference to a variable in <a href="afterglow.show-context.html#var-*show*">*show*</a>. If that variable currently holds a dynamic parameter, try to bind it directly (throw an exception if the types do not match). Otherwise, build a new variable param to bind to future values of that show variable, and return that, logging a warning if the current value (if any) of the show variable is of an incompatible type for the parameter being bound. If the input parameter is not a keyword, simply validate its type.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L212">view source</a></div></div><div class="public anchor" id="var-bind-keyword-param*"><h3>bind-keyword-param*</h3><div class="usage"><code>(bind-keyword-param* param type-expected default param-name)</code></div><div class="doc"><div class="markdown"><p>Helper function that does the work of the <a href="afterglow.effects.params.html#var-bind-keyword-param">bind-keyword-param</a> macro, which passes it the name of the parameter being bound for nice error messages.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L201">view source</a></div></div><div class="public anchor" id="var-build-aim-param"><h3>build-aim-param</h3><div class="usage"><code>(build-aim-param &amp; {:keys [x y z frame-dynamic], :or {x 0, y 0, z 2, frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic aiming parameter for use with <a href="afterglow.effects.movement.html#var-aim-effect">aim-effect</a>. If no arguments are supplied, returns a static direction aiming towards a spot on the floor two meters towards the audience from the center of the light show. Keywords <code>:x</code>, <code>:y</code>, and <code>:z</code> can be used to specify a target point in the <a href="https://github.com/brunchboy/afterglow/blob/master/doc/show_space.adoc#show-space">frame of reference</a> of the light show.</p>
<p>All incoming parameter values may be literal or dynamic, and may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, this aim parameter will be frame dynamic if it has any incoming parameters which themselves are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L782">view source</a></div></div><div class="public anchor" id="var-build-aim-transformer"><h3>build-aim-transformer</h3><div class="usage"><code>(build-aim-transformer aim transform &amp; {:keys [frame-dynamic], :or {frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic aiming parameter for use with <a href="afterglow.effects.movement.html#var-aim-effect">aim-effect</a> which evaluates an incoming aiming parameter and transforms it according to a <code>Transform3D</code> parameter.</p>
<p>All incoming parameter values may be literal or dynamic, and may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, this aim parameter will be frame dynamic if it has any incoming parameters which themselves are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L832">view source</a></div></div><div class="public anchor" id="var-build-color-param"><h3>build-color-param</h3><div class="usage"><code>(build-color-param &amp; {:keys [color r g b h s l adjust-hue adjust-saturation adjust-lightness frame-dynamic], :or {color default-color, frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic color parameter. If supplied, <code>:color</code> is passed to <a href="afterglow.effects.params.html#var-interpret-color">interpret-color</a> to establish the base color to which other arguments are applied. The default base color is black, in the form of all zero values for <code>r</code>, <code>g</code>, <code>b</code>, <code>h</code>, <code>s</code>, and <code>l</code>. To this base it will then assign values passed in for individual color parameters.</p>
<p>All incoming parameter values may be literal or dynamic, and may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>Not all parameter combinations make sense, of course: you will probably want to stick with either some of <code>:h</code>, <code>:s</code>, and <code>:l</code>, or some of <code>:r</code>, <code>:g</code>, and <code>:b</code>. If values from both are supplied, the <code>:r</code>, <code>:g</code>, and/or <code>:b</code> assignments will occur first, then then any <code>:h</code>, <code>:s</code>, and <code>:l</code> assignments will be applied to the resulting color.</p>
<p>Finally, if any adjustment values have been supplied for hue, saturation or lightness, they will be added to the corresponding values (rotating around the hue circle, clamped to the legal range for the others).</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, this color parameter will be frame dynamic if it has any incoming parameters which themselves are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L423">view source</a></div></div><div class="public anchor" id="var-build-direction-param"><h3>build-direction-param</h3><div class="usage"><code>(build-direction-param &amp; {:keys [x y z frame-dynamic], :or {x 0, y 0, z 1, frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic direction parameter for use with <a href="afterglow.effects.movement.html#var-direction-effect">direction-effect</a>. If no arguments are supplied, returns a static direction facing directly out towards the audience. Keywords <code>:x</code>, <code>:y</code>, and <code>:z</code> can be used to specify a vector in the <a href="https://github.com/brunchboy/afterglow/blob/master/doc/show_space.adoc#show-space">frame of reference</a> of the light show.</p>
<p>All incoming parameter values may be literal or dynamic, and may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, this direction parameter will be frame dynamic if it has any incoming parameters which themselves are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L553">view source</a></div></div><div class="public anchor" id="var-build-direction-param-from-pan-tilt"><h3>build-direction-param-from-pan-tilt</h3><div class="usage"><code>(build-direction-param-from-pan-tilt &amp; {:keys [pan tilt radians frame-dynamic], :or {pan 0, tilt 0, frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>An alternative to <a href="afterglow.effects.params.html#var-build-direction-param">build-direction-param</a> for cases in which angles are more convenient than a vector, but when you still want to use a <a href="afterglow.effects.movement.html#var-direction-effect">direction-effect</a>, probably because you want to be able to fade to or from another direction-effect. (In cases where you don’t need to do that, it is simpler to use a <a href="afterglow.effects.movement.html#var-pan-tilt-effect">pan-tilt-effect</a> with <a href="afterglow.effects.params.html#var-build-pan-tilt-param">build-pan-tilt-param</a> and actually have the effect work with pan and tilt angles, the way most lighting software does.)</p>
<p>Returns a dynamic direction parameter specified in terms of pan and tilt angles away from facing directly out towards the audience. If no arguments are supplied, returns a static direction facing directly out towards the audience. Keywords <code>:pan</code> and <code>:tilt</code> can be used to specify angles to turn around the Y and X axes respectively (see <a href="https://github.com/brunchboy/afterglow/blob/master/doc/show_space.adoc#show-space">show space</a> for a diagram of these axes). For human friendliness, the angles are assumed to be in degrees unless keyword <code>:radians</code> is supplied with a true value.</p>
<p>The values passed for <code>:pan</code> and <code>:tilt</code> may be dynamic, or may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, the resulting direction parameter will be frame dynamic if it has any incoming parameters which themselves are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L664">view source</a></div></div><div class="public anchor" id="var-build-direction-transformer"><h3>build-direction-transformer</h3><div class="usage"><code>(build-direction-transformer direction transform &amp; {:keys [frame-dynamic], :or {frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic direction parameter for use with <a href="afterglow.effects.movement.html#var-direction-effect">direction-effect</a> which evaluates an incoming direction parameter and transforms it according to a <code>Transform3D</code> parameter.</p>
<p>All incoming parameter values may be literal or dynamic, and may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, this direction parameter will be frame dynamic if it has any incoming parameters which themselves are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L603">view source</a></div></div><div class="public anchor" id="var-build-pan-tilt-param"><h3>build-pan-tilt-param</h3><div class="usage"><code>(build-pan-tilt-param &amp; {:keys [pan tilt radians frame-dynamic], :or {pan 0, tilt 0, frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic pan/tilt parameter for use with <a href="afterglow.effects.movement.html#var-pan-tilt-effect">pan-tilt-effect</a>, specified in terms of pan and tilt angles away from facing directly out towards the audience. If no arguments are supplied, returns a static orientation facing directly out towards the audience. Keywords <code>:pan</code> and <code>:tilt</code> can be used to specify angles to turn around the Y and X axes respectively (see <a href="https://github.com/brunchboy/afterglow/blob/master/doc/show_space.adoc#show-space">show space</a> for a diagram of these axes). For human friendliness, the angles are assumed to be in degrees unless keyword <code>:radians</code> is supplied with a true value.</p>
<p>The values passed for <code>:pan</code> and <code>:tilt</code> may be dynamic, or may be keywords, which will be dynamically bound to variables in <a href="afterglow.show-context.html#var-*show*">*show*</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, the resulting pan/tilt parameter will be frame dynamic if it has any incoming parameters which themselves are.</p>
<p>Note that if you want to be able to fade the effect you are creating to or from a <a href="afterglow.effects.movement.html#var-direction-effect">direction-effect</a>, you need to create a direction-effect rather than a pan-tilt-effect, and you can instead use <a href="afterglow.effects.params.html#var-build-direction-param-from-pan-tilt">build-direction-param-from-pan-tilt</a> to set its direction.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L725">view source</a></div></div><div class="public anchor" id="var-build-param-formula"><h3>build-param-formula</h3><div class="usage"><code>(build-param-formula param-type calc-fn &amp; input-params)</code></div><div class="doc"><div class="markdown"><p>A helper function to create a dynamic parameter that involves some sort of calculation based on the values of another group of dynamic parameters. The result type reported by the resulting parameter will be <code>param-type</code>.</p>
<p>Whenever the parameter’s value is needed, it will evaluate all of the parameters passed as <code>input-params</code>, and call <code>calc-fn</code> with their current values, returning its result, which must have the type specified by <code>param-type</code>.</p>
<p>The compound dynamic parameter will be frame dynamic if any of its input parameters are.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L989">view source</a></div></div><div class="public anchor" id="var-build-spatial-param"><h3>build-spatial-param</h3><div class="usage"><code>(build-spatial-param fixtures-or-heads f &amp; {:keys [min max frame-dynamic], :or {frame-dynamic :default}})</code></div><div class="doc"><div class="markdown"><p>Returns a dynamic number parameter related to the physical arrangement of the supplied fixtures or heads. First the heads of any fixtures passed in <code>fixtures-or-heads</code> are included. Then function <code>f</code> is called for all fixtures or heads, passing in the fixture or head. It must return a literal number or dynamic number parameter.</p>
<p>If you pass a value with either <code>:max</code> or <code>:min</code> as optional keyword parameters, this activates result scaling. (If you pass only a <code>:max</code> value, <code>:min</code> defaults to zero; if you pass only <code>:min</code>, then <code>:max</code> defaults to 255. If you pass neither, scaling is not performed, and the results from <code>f</code> are returned unchanged.) With scaling active, when it comes time to evaluate this spatial parameter, any dynamic number parameters are evaluated, and the resulting numbers are scaled as a group (after evaluating <code>f</code> for every participating head or fixture) so they fall within the range [<code>:start</code>-<code>:end</code>].</p>
<p>Useful things that <code>f</code> can do include calculating the distance of the head from some point, either in 3D or along an axis, its angle from some line, and so on. These can allow the creation of lighting gradients across all or part of a show. Spatial parameters make excellent building blocks for <a href="#var-build-color-param">color</a>, <a href="#var-build-direction-param">direction</a> and <a href="#var-build-aim-param">aim</a> parameters, as shown in the <a href="https://github.com/brunchboy/afterglow/blob/master/doc/effects.adoc#spatial-effects">effect examples</a>.</p>
<p>If you do not specify an explicit value for <code>:frame-dynamic</code>, this spatial parameter will be frame dynamic if any values returned by <code>f</code> are dynamic parameters which themselves are frame dynamic.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L915">view source</a></div></div><div class="public anchor" id="var-build-step-param"><h3>build-step-param</h3><div class="usage"><code>(build-step-param &amp; {:keys [interval interval-ratio fade-fraction fade-curve starting], :or {interval :beat, interval-ratio 1, fade-fraction 0, fade-curve :linear, starting (when *show* (metro-snapshot (:metronome *show*)))}})</code></div><div class="doc"><div class="markdown"><p>Returns a number parameter that increases over time, ideal for convenient control of <a href="https://github.com/brunchboy/afterglow/blob/master/doc/effects.adoc#chases">chases</a>.</p>
<p>With no arguments, the parameter will evaluate to one at the beat closest when it was created, and will increase by one for each beat that passes, with no fades (fractional states).</p>
<p>The optional keyword argument <code>:interval</code> can be supplied with the value <code>:bar</code> or <code>:phrase</code> to change the timing so that it instead relates to bars or phrases. Supplying a value with <code>:interval-ratio</code> will run the step parameter at the specified fraction or multiple of the chosen interval (beat, bar, or phrase), as illustrated in the <a href="https://github.com/brunchboy/afterglow/blob/master/doc/oscillators.adoc#ratios">Ratios</a> section of the Oscillator documentation.</p>
<p>If fading between steps is desired, the optional keyword argument <code>:fade-fraction</code> can be supplied with a non-zero value (up to but no greater than <code>1</code>). This specifies what fraction of each interval is involved in fading to or from the next value.</p>
<blockquote>
  <p>See the graphs in the Step Parameters <a href="https://github.com/brunchboy/afterglow/blob/master/doc/parameters.adoc#step-parameters">documentation</a> for a visual illustration of how these parameters work.</p>
</blockquote>
<p>A fade fraction of <code>0</code> provides the default behavior of an instant jump between values with no fading. A fade fraction of <code>1</code> means that each value continually fades into the next, and is never steady. A fade fraction of <code>0.5</code> would mean that the value is stable half the time, and fading for the other half: during the middle of the interval, the value is steady at its assigned value; once the final quarter of the interval begins, the value starts fading up, reaching the halfway point as the interval ends, and the fade continues through the first quarter of the next interval, finally stabilizing for the next middle section. Smaller fade fractions mean shorter periods of stability and slower fades, while larger fractions yield longer periods of steady values, and quicker fades.</p>
<p>A smoother look can be obtained by using a sine curve to smooth the start and end of each fade, by passing the optional keyword argument <code>:fade-curve</code> with the value <code>:sine</code>. (Again, see the <a href="https://github.com/brunchboy/afterglow/blob/master/doc/parameters.adoc#step-parameters">graphs</a> to get a visual feel for what this does.)</p>
<p>If the timing should start at an instant other than when the step parameter was created, a metronome snapshot containing the desired start point can be passed with the optional keyword argument <code>:starting</code>.</p>
<p>All incoming parameters may be <a href="https://github.com/brunchboy/afterglow/blob/master/doc/parameters.adoc#dynamic-parameters">dynamic</a>. Step parameters are always frame-dynamic.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L309">view source</a></div></div><div class="public anchor" id="var-build-variable-param"><h3>build-variable-param</h3><div class="usage"><code>(build-variable-param variable &amp; {:keys [frame-dynamic type default transform-fn], :or {frame-dynamic true, type Number, default 0}})</code></div><div class="doc"><div class="markdown"><p>Create a dynamic parameter whose value is determined by the value held in a variable of <a href="afterglow.show-context.html#var-*show*">*show*</a> at the time evaluation is performed. Unless <code>:frame-dynamic</code> is passed a false value, this evaluation will happen every frame.</p>
<p>If no type-compatible value is found in the show variable, a default value is returned. That will be the number zero, unless otherwise specified by <code>:default</code>. The type expected (and returned) by this parameter will be numeric, unless a different value is passed for <code>:type</code>, (in which case a new type-compatible <code>:default</code> value must be specified).</p>
<p>If the named show variable already holds a dyamic parameter at the time this variable parameter is created, the binding is short-circuited to return that existing parameter rather than creating a new one, so the type must be compatible. If <code>:transform-fn</code> is supplied, it will be called with the value of the variable and its return value will be used as the value of the dynamic parameter. It must return a compatible type or its result will be discarded.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L136">view source</a></div></div><div class="public anchor" id="var-check-type"><h3>check-type</h3><div class="usage"><code>(check-type value type-expected name)</code></div><div class="doc"><div class="markdown"><p>Ensure that a parameter is of a particular type, or that it satisfies IParam and, when evaluated, returns that type, throwing an exception otherwise. Used by the validate-param-type macros to do the actual type checking.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L55">view source</a></div></div><div class="public anchor" id="var-frame-dynamic-param.3F"><h3>frame-dynamic-param?</h3><div class="usage"><code>(frame-dynamic-param? arg)</code></div><div class="doc"><div class="markdown"><p>Checks whether the argument is an <a href="afterglow.effects.params.html#var-IParam">IParam</a> which is dynamic to the frame level.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L113">view source</a></div></div><div class="public anchor" id="var-interpret-color"><h3>interpret-color</h3><div class="usage"><code>(interpret-color color)</code></div><div class="doc"><div class="markdown"><p>Accept a color as either a <a href="https://github.com/jolby/colors">jolby/colors</a> object, an <a href="afterglow.effects.params.html#var-IParam">IParam</a> which will produce a color, a keyword, which will be bound to a show variable by the caller, or a string which is passed to the jolby/colors <code>create-color</code> function.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L398">view source</a></div></div><div class="public anchor" id="var-IParam"><h3>IParam</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A dynamic parameter which gets evaluated during the run of a light show, with access to the show and its metronome snapshot.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-evaluate"><h3>evaluate</h3><div class="usage"><code>(evaluate this show snapshot head)</code></div><div class="doc"><div class="markdown"><p>Determine the value of this parameter at a given moment (identified by <code>snapshot</code>) of the <code>show</code>. If the parameter is being evaluated for a specific fixture head, that will be passed in <code>head</code>. If no fixure context is available, <code>head</code> will be <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-frame-dynamic.3F"><h3>frame-dynamic?</h3><div class="usage"><code>(frame-dynamic? this)</code></div><div class="doc"><div class="markdown"><p>If <code>true</code>, this parameter varies at every frame of the show, and must be invoked by effect assigners for each frame of DMX data generated. If <code>false</code>, the value can be determined at the time an effect is created, and passed as a constant to the assigners.</p></div></div></div><div class="public anchor" id="var-resolve-non-frame-dynamic-elements"><h3>resolve-non-frame-dynamic-elements</h3><div class="usage"><code>(resolve-non-frame-dynamic-elements this show snapshot head)</code></div><div class="doc"><div class="markdown"><p>Called when an effect is created using this parameter. If the parameter is not frame-dynamic, this function should return the parameter’s final resolution to a constant of the type returned by <code>result-type</code>; otherwise, it should return a version of the parameter where any of its own non frame-dynamic input parameters have been resolved.</p>
<p>If the parameter is being evaluated for a specific fixture head, that will be passed in <code>head</code>. If no fixure context is available, <code>head</code> will be <code>nil</code>.</p></div></div></div><div class="public anchor" id="var-result-type"><h3>result-type</h3><div class="usage"><code>(result-type this)</code></div><div class="doc"><div class="markdown"><p>The type of value that will be returned when this parameter is resolved.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L26">view source</a></div></div><div class="public anchor" id="var-param.3F"><h3>param?</h3><div class="usage"><code>(param? arg)</code></div><div class="doc"><div class="markdown"><p>Checks whether the argument is an <a href="afterglow.effects.params.html#var-IParam">IParam</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L96">view source</a></div></div><div class="public anchor" id="var-resolve-param"><h3>resolve-param</h3><div class="usage"><code>(resolve-param arg show snapshot)</code><code>(resolve-param arg show snapshot head)</code></div><div class="doc"><div class="markdown"><p>Takes an argument which may be a raw value, or may be an <a href="afterglow.effects.params.html#var-IParam">IParam</a>. If it is the latter, evaluates it and returns the resulting value. Otherwise just returns the value that was passed in.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L101">view source</a></div></div><div class="public anchor" id="var-resolve-unless-frame-dynamic"><h3>resolve-unless-frame-dynamic</h3><div class="usage"><code>(resolve-unless-frame-dynamic arg show snapshot)</code><code>(resolve-unless-frame-dynamic arg show snapshot head)</code></div><div class="doc"><div class="markdown"><p>If the first argument is an <a href="afterglow.effects.params.html#var-IParam">IParam</a> which is not dynamic all the way to the frame level, return the result of resolving it now. If it is dynamic to the frame level, ask it to resolve any non frame-dynamic elements. Otherwise return it unchanged. If <code>head</code> is supplied, and the parameter can use it at resolution time, then pass it along.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L119">view source</a></div></div><div class="public anchor" id="var-validate-optional-param-type"><h3>validate-optional-param-type</h3><h4 class="type">macro</h4><div class="usage"><code>(validate-optional-param-type value type-expected)</code><code>(validate-optional-param-type value type-expected name)</code></div><div class="doc"><div class="markdown"><p>Ensure that a parameter, if not <code>nil</code>, satisfies a predicate, or that it satisfies <a href="afterglow.effects.params.html#var-IParam">IParam</a> and, when evaluated, returns a type that passes that predicate, throwing an exception otherwise.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L86">view source</a></div></div><div class="public anchor" id="var-validate-param-type"><h3>validate-param-type</h3><h4 class="type">macro</h4><div class="usage"><code>(validate-param-type value type-expected)</code><code>(validate-param-type value type-expected name)</code></div><div class="doc"><div class="markdown"><p>Ensure that a parameter satisfies a predicate, or that it satisfies <a href="afterglow.effects.params.html#var-IParam">IParam</a> and, when evaluated, returns a type that passes that predicate, throwing an exception otherwise.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L76">view source</a></div></div><div class="public anchor" id="var-vector-from-pan-tilt"><h3>vector-from-pan-tilt</h3><div class="usage"><code>(vector-from-pan-tilt pan tilt)</code></div><div class="doc"><div class="markdown"><p>Convert a pan and tilt value (angles in radians away from facing directly out towards the audience) to the corresponding aiming vector.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/v0.2.4/src/afterglow/effects/params.clj#L652">view source</a></div></div></div></body></html>