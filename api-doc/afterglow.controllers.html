<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.controllers documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Afterglow</span> <span class="project-version">0.2.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.beyond.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beyond</span></div></a></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2 current"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-3 branch"><a href="afterglow.controllers.launchpad-pro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>launchpad-pro</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.tempo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tempo</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.coremidi4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coremidi4j</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.cues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cues</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-3"><a href="afterglow.effects.show-variable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-variable</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.american-dj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>american-dj</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.qxf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qxf</span></div></a></li><li class="depth-2 branch"><a href="afterglow.init.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shows</span></div></div></li><li class="depth-3"><a href="afterglow.shows.sallie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sallie</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="afterglow.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.show-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-control</span></div></a></li><li class="depth-4 branch"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.web-repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web-repl</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.controllers.html#var-activate-cue.21"><div class="inner"><span>activate-cue!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-add-beat-feedback.21"><div class="inner"><span>add-beat-feedback!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-add-control-held-feedback-overlay"><div class="inner"><span>add-control-held-feedback-overlay</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-add-cue-feedback.21"><div class="inner"><span>add-cue-feedback!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-add-cue-fn.21"><div class="inner"><span>add-cue-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-add-overlay"><div class="inner"><span>add-overlay</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-beat-refresh-interval"><div class="inner"><span>beat-refresh-interval</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-clear-beat-feedback.21"><div class="inner"><span>clear-beat-feedback!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-clear-cue.21"><div class="inner"><span>clear-cue!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-clear-cue-feedback.21"><div class="inner"><span>clear-cue-feedback!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-clear-cue-fn.21"><div class="inner"><span>clear-cue-fn!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-create-overlay-state"><div class="inner"><span>create-overlay-state</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-cue-at"><div class="inner"><span>cue-at</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-cue-grid"><div class="inner"><span>cue-grid</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-grid-dimensions"><div class="inner"><span>grid-dimensions</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-grid-height"><div class="inner"><span>grid-height</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-grid-width"><div class="inner"><span>grid-width</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-IGridController"><div class="inner"><span>IGridController</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-add-move-listener"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>add-move-listener</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-current-bottom"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>current-bottom</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-current-left"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>current-left</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-display-name"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>display-name</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-physical-height"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>physical-height</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-physical-width"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>physical-width</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html#var-remove-move-listener"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>remove-move-listener</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-IOverlay"><div class="inner"><span>IOverlay</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-adjust-interface"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adjust-interface</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-captured-controls"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>captured-controls</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-captured-notes"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>captured-notes</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-handle-aftertouch"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-aftertouch</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-handle-control-change"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-control-change</span></div></a></li><li class="depth-2 branch"><a href="afterglow.controllers.html#var-handle-note-off"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-note-off</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html#var-handle-note-on"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handle-note-on</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-maximum-bpm"><div class="inner"><span>maximum-bpm</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-minimum-bpm"><div class="inner"><span>minimum-bpm</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-overlay-handled.3F"><div class="inner"><span>overlay-handled?</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-pool"><div class="inner"><span>pool</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-report-cue-ending"><div class="inner"><span>report-cue-ending</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-run-overlays"><div class="inner"><span>run-overlays</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-set-cue.21"><div class="inner"><span>set-cue!</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-starting-vars-for-velocity"><div class="inner"><span>starting-vars-for-velocity</span></div></a></li><li class="depth-1"><a href="afterglow.controllers.html#var-value-for-velocity"><div class="inner"><span>value-for-velocity</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">afterglow.controllers</h1><div class="doc"><div class="markdown"><p>Provides shared services for all controller implementations.</p></div></div><div class="public anchor" id="var-activate-cue.21"><h3>activate-cue!</h3><div class="usage"><code>(activate-cue! grid x y id)</code></div><div class="doc"><div class="markdown"><p>Records the fact that the cue at the specified grid coordinates was activated in a show, and assigned the specified <code>id</code>, which can be used later to determine whether the same cue is still running. If <code>id</code> is <code>nil</code>, the cue is deactivated rather than activated.</p>
<p>Sends appropriate MIDI feedback events to any non-grid controllers which have requested them for that cue, so they can update their interfaces appropriately, then calls any registered functions that want updates about the cue state letting them know it has started, its effect keyword, and the <code>id</code> of the effect that was created or ended.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L234">view source</a></div></div><div class="public anchor" id="var-add-beat-feedback.21"><h3>add-beat-feedback!</h3><div class="usage"><code>(add-beat-feedback! metronome device channel kind note &amp; {:keys [on off], :or {on 127, off 0}})</code></div><div class="doc"><div class="markdown"><p>Arranges for the specified non-grid MIDI controller to receive feedback events to make a particular LED flash on each beat of the specified metronome.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L467">view source</a></div></div><div class="public anchor" id="var-add-control-held-feedback-overlay"><h3>add-control-held-feedback-overlay</h3><div class="usage"><code>(add-control-held-feedback-overlay state control-num f)</code></div><div class="doc"><div class="markdown"><p>Builds a simple overlay which just adds something to the user interface until a particular control (identified by <code>control-num</code>) is released, and adds it to the controller. The overlay will end when a control-change message with value 0 is sent to the specified control number. Other than that, all it does is call the supplied function every time the interface is being updated. As with <a href="afterglow.controllers.html#var-add-overlay">add-overlay</a>, <code>state</code> must be a value created by <a href="afterglow.controllers.html#var-create-overlay-state">create-overlay-state</a> and tracked by the controller.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L324">view source</a></div></div><div class="public anchor" id="var-add-cue-feedback.21"><h3>add-cue-feedback!</h3><div class="usage"><code>(add-cue-feedback! grid x y device channel kind note &amp; {:keys [on off], :or {on 127, off 0}})</code></div><div class="doc"><div class="markdown"><p>Arranges for the specified non-grid MIDI controller to receive feedback events when the cue grid location activates or deactivates.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L191">view source</a></div></div><div class="public anchor" id="var-add-cue-fn.21"><h3>add-cue-fn!</h3><div class="usage"><code>(add-cue-fn! grid x y f)</code></div><div class="doc"><div class="markdown"><p>Arranges for the supplied function to be called when the cue grid location activates or deactivates. It will be called with three arguments: the first, a keyword identifying the state to which the cue has transitioned, either <code>:started</code>, <code>:ending</code>, or <code>:ended</code>, the keyword with which the cue created an effect in the show, and the unique numeric ID assigned to the effect when it was started. The last two argumetnts can be used with <a href="afterglow.show.html#var-end-effect.21">end-effect!</a> and its <code>:when-id</code> argument to avoid accidentally ending a different cue.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L207">view source</a></div></div><div class="public anchor" id="var-add-overlay"><h3>add-overlay</h3><div class="usage"><code>(add-overlay state overlay)</code></div><div class="doc"><div class="markdown"><p>Add a temporary overlay to the interface. The <code>state</code> argument must be a value created by <a href="afterglow.controllers.html#var-create-overlay-state">create-overlay-state</a>, and <code>overlay</code> an implementation of the <a href="afterglow.controllers.html#var-IOverlay">IOverlay</a> protocol to be added as the most recent overlay to that state.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L313">view source</a></div></div><div class="public anchor" id="var-beat-refresh-interval"><h3>beat-refresh-interval</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>How often, in milliseconds, are the controllers requesting beat feedback refreshed.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L405">view source</a></div></div><div class="public anchor" id="var-clear-beat-feedback.21"><h3>clear-beat-feedback!</h3><div class="usage"><code>(clear-beat-feedback! metronome device channel kind note)</code></div><div class="doc"><div class="markdown"><p>Ceases flashing the specified non-grid MIDI controller element on beats of the specified metronome.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L450">view source</a></div></div><div class="public anchor" id="var-clear-cue.21"><h3>clear-cue!</h3><div class="usage"><code>(clear-cue! grid x y)</code></div><div class="doc"><div class="markdown"><p>Removes any cue which existed at the specified coordinates in the cue grid. If one was there, updates the grid dimensions if needed.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L147">view source</a></div></div><div class="public anchor" id="var-clear-cue-feedback.21"><h3>clear-cue-feedback!</h3><div class="usage"><code>(clear-cue-feedback! grid x y device channel kind note)</code></div><div class="doc"><div class="markdown"><p>Ceases sending the specified non-grid MIDI controller feedback events when the cue grid location activates or deactivates, returning the feedback values that had been in place if there were any.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L173">view source</a></div></div><div class="public anchor" id="var-clear-cue-fn.21"><h3>clear-cue-fn!</h3><div class="usage"><code>(clear-cue-fn! grid x y f)</code></div><div class="doc"><div class="markdown"><p>Ceases calling the supplied function when the cue grid location activates or deactivates.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L224">view source</a></div></div><div class="public anchor" id="var-create-overlay-state"><h3>create-overlay-state</h3><div class="usage"><code>(create-overlay-state)</code></div><div class="doc"><div class="markdown"><p>Return the state information needed to manage user-interface overlays implementing the <a href="afterglow.controllers.html#var-IOverlay">IOverlay</a> protocol. Controllers implementing this protocol will need to pass this object to the functions that manipulate and invoke overlays.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L304">view source</a></div></div><div class="public anchor" id="var-cue-at"><h3>cue-at</h3><div class="usage"><code>(cue-at grid x y)</code></div><div class="doc"><div class="markdown"><p>Find the cue, if any, at the specified coordinates.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L127">view source</a></div></div><div class="public anchor" id="var-cue-grid"><h3>cue-grid</h3><div class="usage"><code>(cue-grid)</code></div><div class="doc"><div class="markdown"><p>Return a two dimensional arrangement for launching and monitoring cues, suitable for both a web interface and control surfaces with a pad grid. Cues are laid out with [0, 0] being the bottom left corner. The width of the grid is the highest x coordinate of a cue, and the height is the highest y coordinate.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L96">view source</a></div></div><div class="public anchor" id="var-grid-dimensions"><h3>grid-dimensions</h3><div class="usage"><code>(grid-dimensions grid)</code></div><div class="doc"><div class="markdown"><p>Return the current dimensions of the cue grid.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L132">view source</a></div></div><div class="public anchor" id="var-grid-height"><h3>grid-height</h3><div class="usage"><code>(grid-height grid)</code></div><div class="doc"><div class="markdown"><p>Return the current height of the cue grid.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L142">view source</a></div></div><div class="public anchor" id="var-grid-width"><h3>grid-width</h3><div class="usage"><code>(grid-width grid)</code></div><div class="doc"><div class="markdown"><p>Return the current width of the cue grid.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L137">view source</a></div></div><div class="public anchor" id="var-IGridController"><h3>IGridController</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A controller which provides an interface for a section of the cue) grid, and which can be linked to the web interface so they scroll in unison.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-add-move-listener"><h3>add-move-listener</h3><div class="usage"><code>(add-move-listener this f)</code></div><div class="doc"><div class="markdown"><p>Registers a function that will be called whenever the controller&rsquo;s viewport on the overall cue grid is moved, or the controller is deactivated. The function will be called with two arguments, the controller and a keyword which will be either :move or :deactivated. In the latter case, the function will never be called again.</p></div></div></div><div class="public anchor" id="var-current-bottom"><h3>current-bottom</h3><div class="usage"><code>(current-bottom this)</code><code>(current-bottom this y)</code></div><div class="doc"><div class="markdown"><p>Returns the cue grid row currently displayed at the bottom of the controller, or sets it.</p></div></div></div><div class="public anchor" id="var-current-left"><h3>current-left</h3><div class="usage"><code>(current-left this)</code><code>(current-left this x)</code></div><div class="doc"><div class="markdown"><p>Returns the cue grid column currently displayed at the left of the controller, or sets it.</p></div></div></div><div class="public anchor" id="var-display-name"><h3>display-name</h3><div class="usage"><code>(display-name this)</code></div><div class="doc"><div class="markdown"><p>Returns the name by which the controller can be identified in user interfaces.</p></div></div></div><div class="public anchor" id="var-physical-height"><h3>physical-height</h3><div class="usage"><code>(physical-height this)</code></div><div class="doc"><div class="markdown"><p>Returns the height of the cue grid on the controller.</p></div></div></div><div class="public anchor" id="var-physical-width"><h3>physical-width</h3><div class="usage"><code>(physical-width this)</code></div><div class="doc"><div class="markdown"><p>Returns the width of the cue grid on the controller.</p></div></div></div><div class="public anchor" id="var-remove-move-listener"><h3>remove-move-listener</h3><div class="usage"><code>(remove-move-listener this f)</code></div><div class="doc"><div class="markdown"><p>Unregisters a move listener function so it will no longer be called when the controller&rsquo;s origin is moved.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L28">view source</a></div></div><div class="public anchor" id="var-IOverlay"><h3>IOverlay</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>An activity which takes over part of the user interface while it is active.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-adjust-interface"><h3>adjust-interface</h3><div class="usage"><code>(adjust-interface this snapshot)</code></div><div class="doc"><div class="markdown"><p>Set values for the next frame of the controller interface, however that may be done; return a falsey value if the overlay is finished and should be removed. The <code>snapshot</code> is an <a href="null">IMetroSnapshot</a> that specifies the instant in musical time at which the interface is being rendered, so this overlay can be drawn in sync with the rest of the interface.</p></div></div></div><div class="public anchor" id="var-captured-controls"><h3>captured-controls</h3><div class="usage"><code>(captured-controls this)</code></div><div class="doc"><div class="markdown"><p>Returns the MIDI control-change events that will be consumed by this overlay while it is active, a set of integers.</p></div></div></div><div class="public anchor" id="var-captured-notes"><h3>captured-notes</h3><div class="usage"><code>(captured-notes this)</code></div><div class="doc"><div class="markdown"><p>Returns the MIDI note events that will be consumed by this overlay while it is active, a set of integers.</p></div></div></div><div class="public anchor" id="var-handle-aftertouch"><h3>handle-aftertouch</h3><div class="usage"><code>(handle-aftertouch this message)</code></div><div class="doc"><div class="markdown"><p>Called when a MIDI aftertouch event matching the captured-notes lists has been received. Return a truthy value if the overlay has consumed the event, so it should not be processed further. If the special value <code>:done</code> is returned, it further indicates the overlay is finished and should be removed.</p></div></div></div><div class="public anchor" id="var-handle-control-change"><h3>handle-control-change</h3><div class="usage"><code>(handle-control-change this message)</code></div><div class="doc"><div class="markdown"><p>Called when a MIDI control-change event matching the captured-controls lists has been received. Return a truthy value if the overlay has consumed the event, so it should not be processed further. If the special value <code>:done</code> is returned, it further indicates the overlay is finished and should be removed.</p></div></div></div><div class="public anchor" id="var-handle-note-off"><h3>handle-note-off</h3><div class="usage"><code>(handle-note-off this message)</code></div><div class="doc"><div class="markdown"><p>Called when a MIDI note-off event matching the captured-notes lists has been received. Return a truthy value if the overlay has consumed the event, so it should not be processed further. If the special value <code>:done</code> is returned, it further indicates the overlay is finished and should be removed.</p></div></div></div><div class="public anchor" id="var-handle-note-on"><h3>handle-note-on</h3><div class="usage"><code>(handle-note-on this message)</code></div><div class="doc"><div class="markdown"><p>Called when a MIDI note-on event matching the captured-notes lists has been received. Return a truthy value if the overlay has consumed the event, so it should not be processed further. If the special value <code>:done</code> is returned, it further indicates the overlay is finished and should be removed.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L55">view source</a></div></div><div class="public anchor" id="var-maximum-bpm"><h3>maximum-bpm</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The highest BPM value which controllers are allowed to set.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L19">view source</a></div></div><div class="public anchor" id="var-minimum-bpm"><h3>minimum-bpm</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The lowest BPM value which controllers are allowed to set.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L15">view source</a></div></div><div class="public anchor" id="var-overlay-handled.3F"><h3>overlay-handled?</h3><div class="usage"><code>(overlay-handled? state message)</code></div><div class="doc"><div class="markdown"><p>See if there is an interface overlay active which wants to consume this message; if so, send it, and see if the overlay consumes it. Returns truthy if an overlay consumed the message, and it should not be given to anyone else. <code>state</code> must be a value created by <a href="afterglow.controllers.html#var-create-overlay-state">create-overlay-state</a> and tracked by the controller.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L360">view source</a></div></div><div class="public anchor" id="var-pool"><h3>pool</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Provides thread scheduling for all controller user interface updates.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L10">view source</a></div></div><div class="public anchor" id="var-report-cue-ending"><h3>report-cue-ending</h3><div class="usage"><code>(report-cue-ending grid x y id)</code></div><div class="doc"><div class="markdown"><p>Calls any registered functions that want updates about the cue state to inform them it has begun to gracefully end, its effect keyword, and the <code>id</code> of the effect that is ending.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L270">view source</a></div></div><div class="public anchor" id="var-run-overlays"><h3>run-overlays</h3><div class="usage"><code>(run-overlays state snapshot)</code></div><div class="doc"><div class="markdown"><p>Add any contributions from interface overlays, removing them if they report being finished. Most recent overlays run last, having the opportunity to override older ones. <code>state</code> must be a value created by <a href="afterglow.controllers.html#var-create-overlay-state">create-overlay-state</a> and tracked by the controller. The <code>snapshot</code> is an <a href="null">IMetroSnapshot</a> that captures the instant in time at which the interface is being rendered, and is passed in to the overlay so it can be rendered in sync with all other interface elements.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L346">view source</a></div></div><div class="public anchor" id="var-set-cue.21"><h3>set-cue!</h3><div class="usage"><code>(set-cue! grid x y cue)</code></div><div class="doc"><div class="markdown"><p>Puts the supplied cue at the specified coordinates in the cue grid. Replaces any cue which formerly existed at that location. If cue is nil, delegates to clear-cue!</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L160">view source</a></div></div><div class="public anchor" id="var-starting-vars-for-velocity"><h3>starting-vars-for-velocity</h3><div class="usage"><code>(starting-vars-for-velocity cue velocity)</code></div><div class="doc"><div class="markdown"><p>Given a cue and the velocity of the MIDI message which is causing it to start, gather all cue variables which have been configured to respond to MIDI velocity, and assign their initial values based on the velocity of the MIDI message. Returns a map suitable for use with the <code>:var-overrides</code> argument to <a href="afterglow.show.html#var-add-effect-from-cue-grid.21">show/add-effect-from-cue-grid!</a>.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L291">view source</a></div></div><div class="public anchor" id="var-value-for-velocity"><h3>value-for-velocity</h3><div class="usage"><code>(value-for-velocity v velocity)</code></div><div class="doc"><div class="markdown"><p>Given a cue variable which has been configured to respond to MIDI velocity, and the velocity of a MIDI message affecting it (presumably either Note On or Aftertouch / Poly Pressure), calculate the value which should be assigned to that variable.</p></div></div><div class="src-link"><a href="https://github.com/brunchboy/afterglow/blob/master/src/afterglow/controllers.clj#L280">view source</a></div></div></div></body></html>