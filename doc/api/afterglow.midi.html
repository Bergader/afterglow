<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>afterglow.midi documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Afterglow 0.1.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>afterglow</span></div></div></li><li class="depth-2 branch"><a href="afterglow.channels.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channels</span></div></a></li><li class="depth-2"><a href="afterglow.controllers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>controllers</span></div></a></li><li class="depth-3"><a href="afterglow.controllers.ableton-push.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ableton-push</span></div></a></li><li class="depth-2 branch"><a href="afterglow.core.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="afterglow.dj-link.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dj-link</span></div></a></li><li class="depth-2"><a href="afterglow.effects.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>effects</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.dimmer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dimmer</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.fun.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fun</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.movement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movement</span></div></a></li><li class="depth-3 branch"><a href="afterglow.effects.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3"><a href="afterglow.effects.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-2 branch"><a href="afterglow.examples.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>examples</span></div></a></li><li class="depth-2"><a href="afterglow.fixtures.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fixtures</span></div></a></li><li class="depth-3 branch"><a href="afterglow.fixtures.blizzard.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blizzard</span></div></a></li><li class="depth-3"><a href="afterglow.fixtures.chauvet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chauvet</span></div></a></li><li class="depth-2 branch current"><a href="afterglow.midi.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>midi</span></div></a></li><li class="depth-2 branch"><a href="afterglow.ola-client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ola-client</span></div></a></li><li class="depth-2 branch"><a href="afterglow.ola-messages.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ola-messages</span></div></a></li><li class="depth-2 branch"><a href="afterglow.ola-service.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ola-service</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rhythm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rhythm</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rpc-messages.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rpc-messages</span></div></a></li><li class="depth-2 branch"><a href="afterglow.rpc-service.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rpc-service</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show</span></div></a></li><li class="depth-2 branch"><a href="afterglow.show-context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>show-context</span></div></a></li><li class="depth-2 branch"><a href="afterglow.src-generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>src-generator</span></div></a></li><li class="depth-2 branch"><a href="afterglow.transform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2 branch"><a href="afterglow.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="afterglow.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="afterglow.web.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-4 branch"><a href="afterglow.web.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-4"><a href="afterglow.web.routes.visualizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>visualizer</span></div></a></li><li class="depth-3"><a href="afterglow.web.session.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>session</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="afterglow.midi.html#var--.3EClockFinder"><div class="inner"><span>-&gt;ClockFinder</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var--.3EClockSync"><div class="inner"><span>-&gt;ClockSync</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-add-control-mapping"><div class="inner"><span>add-control-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-add-global-handler.21"><div class="inner"><span>add-global-handler!</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-create-midi-port-filter"><div class="inner"><span>create-midi-port-filter</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-create-tempo-tap-handler"><div class="inner"><span>create-tempo-tap-handler</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-IClockFinder"><div class="inner"><span>IClockFinder</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html#var-finder-current-sources"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>finder-current-sources</span></div></a></li><li class="depth-2"><a href="afterglow.midi.html#var-finder-finished"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>finder-finished</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-IClockSync"><div class="inner"><span>IClockSync</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html#var-sync-start"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync-start</span></div></a></li><li class="depth-2 branch"><a href="afterglow.midi.html#var-sync-status"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync-status</span></div></a></li><li class="depth-2"><a href="afterglow.midi.html#var-sync-stop"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync-stop</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-identify-mapping"><div class="inner"><span>identify-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-mac.3F"><div class="inner"><span>mac?</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-map-.3EClockFinder"><div class="inner"><span>map-&gt;ClockFinder</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-map-.3EClockSync"><div class="inner"><span>map-&gt;ClockSync</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-mmj-device.3F"><div class="inner"><span>mmj-device?</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-mmj-installed.3F"><div class="inner"><span>mmj-installed?</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-open-inputs-if-needed.21"><div class="inner"><span>open-inputs-if-needed!</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-open-outputs-if-needed.21"><div class="inner"><span>open-outputs-if-needed!</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-remove-control-mapping"><div class="inner"><span>remove-control-mapping</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-remove-global-handler.21"><div class="inner"><span>remove-global-handler!</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-sync-to-midi-clock"><div class="inner"><span>sync-to-midi-clock</span></div></a></li><li class="depth-1"><a href="afterglow.midi.html#var-watch-for-clock-sources"><div class="inner"><span>watch-for-clock-sources</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">afterglow.midi</h2><div class="doc"><pre class="plaintext">Handles MIDI communication, including syncing a show metronome to MIDI clock pulses.
</pre></div><div class="public anchor" id="var--.3EClockFinder"><h3>-&gt;ClockFinder</h3><div class="usage"><code>(-&gt;ClockFinder listener results)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class afterglow.midi.ClockFinder.
</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L290">view source</a></div></div><div class="public anchor" id="var--.3EClockSync"><h3>-&gt;ClockSync</h3><div class="usage"><code>(-&gt;ClockSync metronome midi-clock-source buffer)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class afterglow.midi.ClockSync.
</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L254">view source</a></div></div><div class="public anchor" id="var-add-control-mapping"><h3>add-control-mapping</h3><div class="usage"><code>(add-control-mapping name-filter channel control-number key handler)</code></div><div class="doc"><pre class="plaintext">Register a handler to be called whenever a MIDI controller change
message is received from the specified device, on the specified
channel and controller number. A unique key must be given, by which
this mapping can later be removed. Any subsequent MIDI message which
matches will be passed to the handler as its single argument. The
first MIDI input source whose name or description matches the string
or regex pattern supplied for name-filter will be chosen.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L365">view source</a></div></div><div class="public anchor" id="var-add-global-handler.21"><h3>add-global-handler!</h3><div class="usage"><code>(add-global-handler! handler)</code></div><div class="doc"><pre class="plaintext">Add a function to be called whenever any MIDI message is received.
The function will be called with the message, and must return
quickly, so as to not block delivery to other recipients.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L33">view source</a></div></div><div class="public anchor" id="var-create-midi-port-filter"><h3>create-midi-port-filter</h3><div class="usage"><code>(create-midi-port-filter)</code></div><div class="doc"><pre class="plaintext">Return a filter which selects midi inputs and outputs we actually
want to use. If this is a Mac, and the Humatic MIDI extension has
been installed, create a filter which will accept only its versions
of ports which it offers in parallel with the standard
implementation. Otherwise, return a filter which accepts all ports.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L117">view source</a></div></div><div class="public anchor" id="var-create-tempo-tap-handler"><h3>create-tempo-tap-handler</h3><div class="usage"><code>(create-tempo-tap-handler metronome)</code></div><div class="doc"><pre class="plaintext">Returns a function which implements a simple tempo-tap algorithm on
the supplied metronome.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L201">view source</a></div></div><div class="public anchor" id="var-IClockFinder"><h3>IClockFinder</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Allows a list of available MIDI clock sources to be gathered, for
presentation in a user interface, by monitoring for clock pulses on
all ports.</pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-finder-current-sources"><h3>finder-current-sources</h3><div class="usage"><code>(finder-current-sources this)</code></div><div class="doc"><pre class="plaintext">Return the set of sources seen so far.
</pre></div></div><div class="public anchor" id="var-finder-finished"><h3>finder-finished</h3><div class="usage"><code>(finder-finished this)</code></div><div class="doc"><pre class="plaintext">Stop listening for clock pulses and clean up.
</pre></div></div></div></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L220">view source</a></div></div><div class="public anchor" id="var-IClockSync"><h3>IClockSync</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext">A simple protocol for our clock sync object, allowing it to be
started and stopped, and the status checked.</pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-sync-start"><h3>sync-start</h3><div class="usage"><code>(sync-start this)</code></div><div class="doc"><pre class="plaintext">Start synchronizing your metronome.
</pre></div></div><div class="public anchor" id="var-sync-status"><h3>sync-status</h3><div class="usage"><code>(sync-status this)</code></div><div class="doc"><pre class="plaintext">Report on how well synchronization is working.
</pre></div></div><div class="public anchor" id="var-sync-stop"><h3>sync-stop</h3><div class="usage"><code>(sync-stop this)</code></div><div class="doc"><pre class="plaintext">Stop synchronizing your metronome.
</pre></div></div></div></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L213">view source</a></div></div><div class="public anchor" id="var-identify-mapping"><h3>identify-mapping</h3><div class="usage"><code>(identify-mapping)</code><code>(identify-mapping timeout)</code></div><div class="doc"><pre class="plaintext">Report on the next MIDI control or note message received, to aid in
setting up a mapping to a button, fader, or knob. Call this, then
twiddle the knob, press the button, or move the fader, and see what
Afterglow received. Pass a timeout in ms to control how long it will
wait for a message (the default is ten seconds). This is an upper
limit; if a message is received before the timeout, it will be
reported immediately.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L341">view source</a></div></div><div class="public anchor" id="var-mac.3F"><h3>mac?</h3><div class="usage"><code>(mac?)</code></div><div class="doc"><pre class="plaintext">Return true if we seem to be running on a Mac.
</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L101">view source</a></div></div><div class="public anchor" id="var-map-.3EClockFinder"><h3>map-&gt;ClockFinder</h3><div class="usage"><code>(map-&gt;ClockFinder m__6287__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class afterglow.midi.ClockFinder, taking a map of keywords to field values.
</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L290">view source</a></div></div><div class="public anchor" id="var-map-.3EClockSync"><h3>map-&gt;ClockSync</h3><div class="usage"><code>(map-&gt;ClockSync m__6287__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class afterglow.midi.ClockSync, taking a map of keywords to field values.
</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L254">view source</a></div></div><div class="public anchor" id="var-mmj-device.3F"><h3>mmj-device?</h3><div class="usage"><code>(mmj-device? device)</code></div><div class="doc"><pre class="plaintext">Checks whether a MIDI device was returned by the Humatic mmj
MIDI extension.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L106">view source</a></div></div><div class="public anchor" id="var-mmj-installed.3F"><h3>mmj-installed?</h3><div class="usage"><code>(mmj-installed?)</code></div><div class="doc"><pre class="plaintext">Return true if the Humatic mmj Midi extension is present.
</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L112">view source</a></div></div><div class="public anchor" id="var-open-inputs-if-needed.21"><h3>open-inputs-if-needed!</h3><div class="usage"><code>(open-inputs-if-needed!)</code></div><div class="doc"><pre class="plaintext">Make sure the MIDI input ports are open and ready to distribute events.
Returns the opened inputs.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L135">view source</a></div></div><div class="public anchor" id="var-open-outputs-if-needed.21"><h3>open-outputs-if-needed!</h3><div class="usage"><code>(open-outputs-if-needed!)</code></div><div class="doc"><pre class="plaintext">Make sure the MIDI output ports are open and ready to receive events.
Returns the opened outputs.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L147">view source</a></div></div><div class="public anchor" id="var-remove-control-mapping"><h3>remove-control-mapping</h3><div class="usage"><code>(remove-control-mapping name-filter channel control-number key)</code></div><div class="doc"><pre class="plaintext">Unregister a handler previously registered with
add-control-mapping, identified by the unique key. The first MIDI
input source whose name or description matches the string or regex
pattern supplied for name-filter will be chosen.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L381">view source</a></div></div><div class="public anchor" id="var-remove-global-handler.21"><h3>remove-global-handler!</h3><div class="usage"><code>(remove-global-handler! handler)</code></div><div class="doc"><pre class="plaintext">Remove a function that was being called whenever any MIDI message is
received.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L40">view source</a></div></div><div class="public anchor" id="var-sync-to-midi-clock"><h3>sync-to-midi-clock</h3><div class="usage"><code>(sync-to-midi-clock)</code><code>(sync-to-midi-clock name-filter)</code></div><div class="doc"><pre class="plaintext">Returns a sync function that will cause the beats-per-minute
setting of the supplied metronome to track the MIDI clock messages
received from the named MIDI source. This is intended for use with
afterglow.show/sync-to-external-clock. name-filter is only needed if
there is more than one connected device sending MIDI clock messages
when this function is invoked; it will be used to filter the
eligible devices. If it is a string, then the device name or
description must contain it. If it is a regular expression, the
device name or description must match it. If it is nil or a blank
string, no filtering is done. An exception will be thrown if there
is not exactly one matching eligible MIDI clock source.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L309">view source</a></div></div><div class="public anchor" id="var-watch-for-clock-sources"><h3>watch-for-clock-sources</h3><div class="usage"><code>(watch-for-clock-sources)</code></div><div class="doc"><pre class="plaintext">Returns a clock finder that will watch for sources of MIDI clock
pulses until you tell it to stop.</pre></div><div class="src-link"><a href="http://github.com/brunchboy/afterglow/blob/master/src/afterglow/midi.clj#L297">view source</a></div></div></div></body></html>